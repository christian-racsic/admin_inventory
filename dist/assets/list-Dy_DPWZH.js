import{i as R}from"./constants-BXcKDdXi.js";import{r,o as Q,c as p,a as i,w as l,b as e,d as n,t as v,e as se,f as V,u as o,g as m,V as P,s as ne,x as re,h as N,k as M,i as k,l as B,F as ie,j as ue}from"./index-C2VmLSsf.js";import{_ as de}from"./DialogCloseBtn-CDkbfzzn.js";import{$ as K}from"./api-fBbxbWV9.js";import{V as W}from"./VCard-BsRs2Dbz.js";import{V as X}from"./VCardText-fQi82b2X.js";import{V as ce}from"./VForm-CT43qB3J.js";import{V as L,a as u}from"./VRow-CKub-qAo.js";import{V as F}from"./VAlert-ku1xFGr_.js";import{V as pe}from"./VDialog-DJHst2CE.js";import{_ as me}from"./IconBtn-DDZ12Udw.js";import{_ as fe}from"./AppDateTimePicker-DtxdjnaA.js";import{V as O}from"./VTextField-BvYPkTzd.js";import{V as z}from"./VSelect-Ce3hOZLi.js";import{V as G}from"./VTooltip-DS6N_1b9.js";import{V as _e}from"./VTable-Rng3EBBw.js";import{V as j}from"./VChip-DLC_ftk3.js";import{V as Ve}from"./VPagination-BavTEBhF.js";import"./index-BYrzgnBV.js";import"./VAvatar-CrWFUmzB.js";import"./VImg-BjZkJGgN.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VOverlay-BuiK-fz4.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VList-C6VPgDKA.js";import"./VDivider-IUxUQjJr.js";import"./VMenu-Dk04Zlg9.js";import"./VCheckboxBtn-D1ZcYjYr.js";const ve={class:"text-center pb-6"},ge={class:"text-h4 mb-2"},he={__name:"TransportDeleteDialog",props:{isDialogVisible:{type:Boolean,required:!0},transportSelected:{type:Object,required:!0}},emits:["update:isDialogVisible","deleteTransport"],setup(q,{emit:S}){const d=q,f=S,D=r(null),g=r(null),w=r(null),A=async()=>{D.value=null,g.value=null,w.value=null;try{const c=await K("transports/"+d.transportSelected.id,{method:"DELETE",onResponseError({response:y}){g.value=y._data.error}});console.log(c),f("deleteTransport",d.transportSelected),h()}catch(c){console.log(c)}};Q(()=>{console.log(d.transportSelected)});const h=()=>{f("update:isDialogVisible",!1)},T=c=>{f("update:isDialogVisible",c)};return(c,y)=>{const _=de;return i(),p(pe,{"max-width":"650","model-value":d.isDialogVisible,"onUpdate:modelValue":T},{default:l(()=>[e(W,{class:"pa-sm-11 pa-3"},{default:l(()=>[e(_,{variant:"text",size:"default",onClick:h}),e(X,{class:"pt-5"},{default:l(()=>[n("div",ve,[n("h4",ge," Delete Transport : "+v(d.transportSelected.id),1)]),e(ce,{class:"mt-4",onSubmit:se(A,["prevent"])},{default:l(()=>[e(L,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[n("p",null,"Â¿Estas seguro de eliminar esta solicitud de transporte : #"+v(d.transportSelected.id)+"?",1)]),_:1}),o(D)?(i(),p(u,{key:0,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"warning"},{default:l(()=>[m(v(o(D)),1)]),_:1})]),_:1})):V("",!0),o(g)?(i(),p(u,{key:1,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"error"},{default:l(()=>[m(v(o(g)),1)]),_:1})]),_:1})):V("",!0),o(w)?(i(),p(u,{key:2,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"success"},{default:l(()=>[m(v(o(w)),1)]),_:1})]),_:1})):V("",!0),e(u,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(P,{type:"submit",color:"error"},{default:l(()=>[m(" Eliminar ")]),_:1}),e(P,{color:"secondary",variant:"outlined",onClick:h},{default:l(()=>[m(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}};var ye={};const be=n("thead",null,[n("tr",null,[n("th",{class:"text-uppercase"}," NÂ° Transporte "),n("th",{class:"text-uppercase"}," Solicitante "),n("th",{class:"text-uppercase"}," AlmacÃ©n de atenciÃ³n "),n("th",{class:"text-uppercase"}," AlmacÃ©n de entrega "),n("th",{class:"text-uppercase"}," Fecha de emisiÃ³n "),n("th",{class:"text-uppercase"}," Estado de E. "),n("th",{class:"text-uppercase"}," Acciones ")])],-1),ke={class:"d-flex gap-1"},Ye={__name:"list",setup(q){const S=ne(),d=r(!1),f=r(1),D=r(0),g=r([]),w=r([]),A=r([]),h=r(null),T=r(null),c=r(null),y=r(null),_=r(null),$=r(null),I=r(null),E="http://api-ciscarerp.duckdns.org/api".replace(/\/+$/,""),U=(ye.VITE_API_PATH||"api").replace(/^\/+|\/+$/g,""),J=E?E.endsWith("/"+U)?E:`${E}/${U}`:`/${U}`,x=async()=>{try{const s={search:h.value,warehouse_start_id:T.value,warehouse_end_id:c.value,unit_id:y.value,start_date:_.value?_.value.split("to")[0]:null,end_date:_.value?_.value.split("to")[1]:null,search_product:$.value},t=await K(`transports/index?page=${f.value}`,{method:"POST",body:s,onResponseError({response:b}){var C;console.log((C=b._data)==null?void 0:C.error)}});g.value=t.transports.data,D.value=t.total_page}catch(s){console.log(s)}};re(f,()=>{x()});const Y=()=>{h.value="",T.value=null,c.value=null,y.value=null,f.value=1,_.value=null,$.value="",x()},Z=async()=>{try{const s=await K("transports/config",{method:"GET",onResponseError({response:t}){var b;console.log((b=t._data)==null?void 0:b.error)}});w.value=s.warehouses,A.value=s.units}catch(s){console.log(s)}},ee=s=>{S.push({name:"transport-edit-id",params:{id:s.id}})},le=s=>{d.value=!0,I.value=s},te=s=>{const t=g.value.findIndex(b=>b.id==s.id);t!==-1&&g.value.splice(t,1)},ae=s=>{const t=`${J}/transport-pdf/${s.id}`;window.open(t,"_blank")};return Q(()=>{x(),Z()}),(s,t)=>{const b=fe,C=me,oe=he;return i(),N("div",null,[e(W,{title:"ðŸšš Transportes"},{default:l(()=>[e(X,null,{default:l(()=>[e(L,{class:""},{default:l(()=>[e(u,{cols:"10"},{default:l(()=>[e(L,null,{default:l(()=>[e(u,{cols:"3"},{default:l(()=>[e(O,{placeholder:"Buscar NÂ° Transporte",density:"compact",class:"me-3",modelValue:o(h),"onUpdate:modelValue":t[0]||(t[0]=a=>k(h)?h.value=a:null),onKeyup:M(x,["enter"])},null,8,["modelValue"])]),_:1}),e(u,{cols:"3"},{default:l(()=>[e(z,{items:o(w),"item-title":"name","item-value":"id",placeholder:"Seleccionar",modelValue:o(T),"onUpdate:modelValue":t[1]||(t[1]=a=>k(T)?T.value=a:null),label:"AlmacÃ©n de atenciÃ³n"},null,8,["items","modelValue"])]),_:1}),e(u,{cols:"3"},{default:l(()=>[e(z,{items:o(w),"item-title":"name","item-value":"id",placeholder:"Seleccionar",modelValue:o(c),"onUpdate:modelValue":t[2]||(t[2]=a=>k(c)?c.value=a:null),label:"AlmacÃ©n de entrega"},null,8,["items","modelValue"])]),_:1}),e(u,{cols:"3"},{default:l(()=>[e(z,{items:o(A),"item-title":"name","item-value":"id",placeholder:"Select",modelValue:o(y),"onUpdate:modelValue":t[3]||(t[3]=a=>k(y)?y.value=a:null),label:"Unidades"},null,8,["items","modelValue"])]),_:1}),e(u,{cols:"3"},{default:l(()=>[e(b,{modelValue:o(_),"onUpdate:modelValue":t[4]||(t[4]=a=>k(_)?_.value=a:null),label:"Rango de fecha",placeholder:"Select date",config:{mode:"range"}},null,8,["modelValue"])]),_:1}),e(u,{cols:"3"},{default:l(()=>[e(O,{placeholder:"Buscar Producto",density:"compact",class:"me-3",modelValue:o($),"onUpdate:modelValue":t[5]||(t[5]=a=>k($)?$.value=a:null),onKeyup:M(x,["enter"])},null,8,["modelValue"])]),_:1}),e(u,{cols:"2"},{default:l(()=>[e(P,{color:"info",class:"mx-1","prepend-icon":"ri-search-2-line",onClick:t[6]||(t[6]=a=>x())},{default:l(()=>[e(G,{activator:"parent",location:"top"},{default:l(()=>[m(" Buscar ")]),_:1})]),_:1}),e(P,{color:"secondary",class:"mx-1","prepend-icon":"ri-restart-line",onClick:t[7]||(t[7]=a=>Y())},{default:l(()=>[e(G,{activator:"parent",location:"top"},{default:l(()=>[m(" Limpieza ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{cols:"2",class:"text-end"},{default:l(()=>[("isPermission"in s?s.isPermission:o(R))("register_transport")?(i(),p(P,{key:0,onClick:t[8]||(t[8]=a=>o(S).push({name:"transport-add"}))},{default:l(()=>[m(" Add Transport "),e(B,{end:"",icon:"ri-add-line"})]),_:1})):V("",!0)]),_:1})]),_:1})]),_:1}),e(_e,null,{default:l(()=>[be,n("tbody",null,[(i(!0),N(ie,null,ue(o(g),a=>(i(),N("tr",{key:a.id},[n("td",null,v(a.id),1),n("td",null,v(a.user.full_name),1),n("td",null,v(a.warehouse_start.name),1),n("td",null,v(a.warehouse_end.name),1),n("td",null,v(a.date_emision),1),n("td",null,[a.state==1?(i(),p(j,{key:0,color:"error"},{default:l(()=>[m(" Solicitud ")]),_:1})):V("",!0),a.state==3?(i(),p(j,{key:1,color:"warning"},{default:l(()=>[m(" Salida ")]),_:1})):V("",!0),a.state==6?(i(),p(j,{key:2,color:"primary"},{default:l(()=>[m(" Entregado ")]),_:1})):V("",!0)]),n("td",null,[n("div",ke,[e(C,{size:"small",onClick:H=>ae(a)},{default:l(()=>[e(B,{icon:"ri-file-pdf-2-line"})]),_:2},1032,["onClick"]),("isPermission"in s?s.isPermission:o(R))("edit_transport")?(i(),p(C,{key:0,size:"small",onClick:H=>ee(a)},{default:l(()=>[e(B,{icon:"ri-pencil-line"})]),_:2},1032,["onClick"])):V("",!0),a.state<3&&("isPermission"in s?s.isPermission:o(R))("delete_transport")?(i(),p(C,{key:1,size:"small",onClick:H=>le(a)},{default:l(()=>[e(B,{icon:"ri-delete-bin-line"})]),_:2},1032,["onClick"])):V("",!0)])])]))),128))])]),_:1}),e(Ve,{modelValue:o(f),"onUpdate:modelValue":t[9]||(t[9]=a=>k(f)?f.value=a:null),length:o(D)},null,8,["modelValue","length"])]),_:1}),o(I)&&o(d)?(i(),p(oe,{key:0,isDialogVisible:o(d),"onUpdate:isDialogVisible":t[10]||(t[10]=a=>k(d)?d.value=a:null),transportSelected:o(I),onDeleteTransport:te},null,8,["isDialogVisible","transportSelected"])):V("",!0)])}}};export{Ye as default};
