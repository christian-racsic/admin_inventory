import{i as q}from"./constants-BXcKDdXi.js";import{r as i,o as X,c as p,a as u,w as e,b as l,d as r,t as m,e as Y,f as v,u as s,g as n,V as S,s as de,x as ce,h as B,k as pe,i as P,l as K,F as me,j as fe,C as _e}from"./index-W4kja-31.js";import{_ as J}from"./DialogCloseBtn-Cpwqmvb9.js";import{$ as L}from"./api-DxrbhZSf.js";import{V as H}from"./VCard-CrSgQsdG.js";import{V as Q}from"./VCardText-D-w9kZpv.js";import{V as W}from"./VForm-D3Vuhlg_.js";import{V as j,a as d}from"./VRow-f7OHVuKd.js";import{V as $}from"./VAlert-ELbKA5bW.js";import{V as Z}from"./VDialog-CqxdfU_E.js";import{V as ve}from"./VFileInput-YfqDUgYs.js";import{_ as ge}from"./IconBtn-BnO4JjSS.js";import{V as Ve}from"./VTextField-DIHLaahk.js";import{V as O}from"./VSelect-CLTqdzaG.js";import{V as z}from"./VTooltip-DOtX7Pla.js";import{V as be}from"./VTable-Cddsam7K.js";import{V as xe}from"./VAvatar-D-KF6a6N.js";import{V as ye}from"./VImg-BXz4PYAy.js";import{V as N}from"./VChip-6YKG-Q6j.js";import{V as ke}from"./VPagination-D84KJ4BT.js";import"./index-BYrzgnBV.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VOverlay-DsWRzxlS.js";import"./VList-DFWg69W8.js";import"./VDivider-D7rU52Ox.js";import"./VMenu-HxKMt7sI.js";import"./VCheckboxBtn-D15mcKdF.js";const De={class:"text-center pb-6"},he={class:"text-h4 mb-2"},Pe={__name:"ProductDeleteDialog",props:{isDialogVisible:{type:Boolean,required:!0},productSelected:{type:Object,required:!0}},emits:["update:isDialogVisible","deleteProduct"],setup(F,{emit:U}){const g=F,b=U,_=i(null),x=i(null),f=i(null),h=async()=>{_.value=null,x.value=null,f.value=null;try{const y=await L("products/"+g.productSelected.id,{method:"DELETE",onResponseError({response:k}){x.value=k._data.error}});console.log(y),b("deleteProduct",g.productSelected),w()}catch(y){console.log(y)}};X(()=>{console.log(g.productSelected)});const w=()=>{b("update:isDialogVisible",!1)},R=y=>{b("update:isDialogVisible",y)};return(y,k)=>{const c=J;return u(),p(Z,{"max-width":"650","model-value":g.isDialogVisible,"onUpdate:modelValue":R},{default:e(()=>[l(H,{class:"pa-sm-11 pa-3"},{default:e(()=>[l(c,{variant:"text",size:"default",onClick:w}),l(Q,{class:"pt-5"},{default:e(()=>[r("div",De,[r("h4",he," Delete Product : "+m(g.productSelected.title),1)]),l(W,{class:"mt-4",onSubmit:Y(h,["prevent"])},{default:e(()=>[l(j,null,{default:e(()=>[l(d,{cols:"12"},{default:e(()=>[r("p",null,"Â¿Estas seguro de eliminar el Producto : "+m(g.productSelected.title)+"?",1)]),_:1}),s(_)?(u(),p(d,{key:0,cols:"12"},{default:e(()=>[l($,{closable:"","close-label":"Close Alert",color:"warning"},{default:e(()=>[n(m(s(_)),1)]),_:1})]),_:1})):v("",!0),s(x)?(u(),p(d,{key:1,cols:"12"},{default:e(()=>[l($,{closable:"","close-label":"Close Alert",color:"error"},{default:e(()=>[n(m(s(x)),1)]),_:1})]),_:1})):v("",!0),s(f)?(u(),p(d,{key:2,cols:"12"},{default:e(()=>[l($,{closable:"","close-label":"Close Alert",color:"success"},{default:e(()=>[n(m(s(f)),1)]),_:1})]),_:1})):v("",!0),l(d,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:e(()=>[l(S,{type:"submit",color:"error"},{default:e(()=>[n(" Eliminar ")]),_:1}),l(S,{color:"secondary",variant:"outlined",onClick:w},{default:e(()=>[n(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},Ce=r("div",{class:"text-center pb-6"},[r("h4",{class:"text-h4 mb-2"}," Import Excel Product ")],-1),Ee={__name:"ImportExcelProduct",props:{isDialogVisible:{type:Boolean,required:!0}},emits:["update:isDialogVisible","importExcelProduct"],setup(F,{emit:U}){const g=F,b=U,_=i(null),x=i(null),f=i(null),h=i(null),w=async()=>{if(x.value=null,f.value=null,h.value=null,!_.value){setTimeout(()=>{x.value="Se debe subir un archivo excel para la importaciÃ³n"},50);return}let c=new FormData;c.append("excel",_.value);try{const V=await L("products/import-excel",{method:"POST",body:c,onResponseError({response:D}){f.value=D._data.error}});console.log(V),h.value="La importaciÃ³n se ha realizado correctamente",b("importExcelProduct",200),_.value="",x.value=null,f.value=null,h.value=null,y()}catch(V){console.log(V)}},R=c=>{if(c.target.files[0].type.indexOf("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")<0){f.value="SOLAMENTE PUEDEN SER ARCHIVOS DE TIPO IMAGEN",_.value=null;return}f.value="",_.value=c.target.files[0]},y=()=>{b("update:isDialogVisible",!1)},k=c=>{b("update:isDialogVisible",c)};return(c,V)=>{const D=J;return u(),p(Z,{"max-width":"650","model-value":g.isDialogVisible,"onUpdate:modelValue":k},{default:e(()=>[l(H,{class:"pa-sm-11 pa-3"},{default:e(()=>[l(D,{variant:"text",size:"default",onClick:y}),l(Q,{class:"pt-5"},{default:e(()=>[Ce,l(W,{class:"mt-4",onSubmit:Y(w,["prevent"])},{default:e(()=>[l(j,null,{default:e(()=>[s(x)?(u(),p(d,{key:0,cols:"12"},{default:e(()=>[l($,{closable:"","close-label":"Close Alert",color:"warning"},{default:e(()=>[n(m(s(x)),1)]),_:1})]),_:1})):v("",!0),s(f)?(u(),p(d,{key:1,cols:"12"},{default:e(()=>[l($,{closable:"","close-label":"Close Alert",color:"error"},{default:e(()=>[n(m(s(f)),1)]),_:1})]),_:1})):v("",!0),s(h)?(u(),p(d,{key:2,cols:"12"},{default:e(()=>[l($,{closable:"","close-label":"Close Alert",color:"success"},{default:e(()=>[n(m(s(h)),1)]),_:1})]),_:1})):v("",!0),l(d,{cols:"12"},{default:e(()=>[l(ve,{label:"SUBE TU ARCHIVO",onChange:V[0]||(V[0]=C=>R(C))})]),_:1}),l(d,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:e(()=>[l(S,{type:"submit"},{default:e(()=>[n(" Importar ")]),_:1}),l(S,{color:"secondary",variant:"outlined",onClick:y},{default:e(()=>[n(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},Se=r("thead",null,[r("tr",null,[r("th",{class:"text-uppercase"}," Producto "),r("th",{class:"text-uppercase"}," SKU "),r("th",{class:"text-uppercase"}," Categoria "),r("th",{class:"text-uppercase"}," Â¿Es un regalo? "),r("th",{class:"text-uppercase"}," Â¿Tiene descuento? "),r("th",{class:"text-uppercase"}," Importe Iva "),r("th",{class:"text-uppercase"}," Dias de garantia "),r("th",{class:"text-uppercase"}," Estado "),r("th",{class:"text-uppercase"}," Fecha de registro "),r("th",{class:"text-uppercase"}," Acciones ")])],-1),we={class:"d-flex align-center"},Ie={key:1,class:"text-sm"},Ae={class:"d-flex ms-3"},Ue=r("br",null,null,-1),Re={key:0,style:{"text-wrap-mode":"nowrap"}},Te={class:"d-flex gap-1"},nl={__name:"list",setup(F){const U=de(),g=i(!1),b=i(!1),_=i(1),x=i(0),f=i([]),h=i([]),w=i([]),R=i([]),y=i([]),k=i(null),c=i(null),V=i(null),D=i(null),C=i(null),I=i(null),A=i(null),M=i(null),T=async()=>{try{let a={search:k.value,product_categorie_id:c.value,warehouse_id:V.value,unit_id:D.value,sucursale_id:C.value,disponibilidad:I.value,is_gift:A.value};const o=await L("products/index?page="+_.value,{method:"POST",body:a,onResponseError({response:E}){console.log(E._data.error)}});console.log(o),f.value=o.products.data,x.value=o.total_page}catch(a){console.log(a)}};ce(_,a=>{console.log(a),T()});const ee=()=>{k.value="",c.value=null,V.value=null,D.value=null,C.value=null,I.value=null,A.value=null,_.value=1,T()},le=async()=>{try{const a=await L("products/config",{method:"GET",onResponseError({response:o}){console.log(o._data.error)}});console.log(a),h.value=a.sucursales,w.value=a.warehouses,R.value=a.units,y.value=a.categories}catch(a){console.log(a)}},te=()=>{let a="";k.value&&(a+="&search="+k.value),c.value&&(a+="&product_categorie_id="+c.value),V.value&&(a+="&warehouse_id="+V.value),D.value&&(a+="&unit_id="+D.value),C.value&&(a+="&sucursale_id="+C.value),A.value&&(a+="&is_gift="+A.value),I.value&&(a+="&disponibilidad="+I.value),window.open("http://api.ciscarerp.duckdns.org/apiproducts-excel?z=1"+a,"_blank")},oe=()=>{T()},ae=a=>{console.log(a);let o=f.value;f.value=[];let E=o.findIndex(G=>G.id==a.id);E!=-1&&o.splice(E,1),setTimeout(()=>{f.value=o},50)},se=a=>{console.log(a),U.push({name:"product-edit-id",params:{id:a.id}})},re=a=>{g.value=!0,M.value=a},ie=a=>a?a.split(" ").map(E=>E.charAt(0).toUpperCase()).join(""):"";return X(()=>{T(),le()}),(a,o)=>{const E=ge,G=Ee,ue=Pe;return u(),B("div",null,[l(H,{title:"ðŸ–¥ï¸ Productos"},{default:e(()=>[l(Q,null,{default:e(()=>[l(j,{class:""},{default:e(()=>[l(d,{cols:"10"},{default:e(()=>[l(j,null,{default:e(()=>[l(d,{cols:"3"},{default:e(()=>[l(Ve,{placeholder:"Buscar producto (pulsa Enter)",density:"compact",class:"me-3",modelValue:s(k),"onUpdate:modelValue":o[0]||(o[0]=t=>P(k)?k.value=t:null),onKeyup:pe(T,["enter"])},null,8,["modelValue"])]),_:1}),l(d,{cols:"3"},{default:e(()=>[l(O,{placeholder:"Select",label:"Categoria",items:s(y),"item-title":"name","item-value":"id",modelValue:s(c),"onUpdate:modelValue":o[1]||(o[1]=t=>P(c)?c.value=t:null)},null,8,["items","modelValue"])]),_:1}),l(d,{cols:"3"},{default:e(()=>[l(O,{items:s(w),"item-title":"name","item-value":"id",placeholder:"Select",modelValue:s(V),"onUpdate:modelValue":o[2]||(o[2]=t=>P(V)?V.value=t:null),label:"Almacenes"},null,8,["items","modelValue"])]),_:1}),l(d,{cols:"3"},{default:e(()=>[l(O,{items:s(R),"item-title":"name","item-value":"id",placeholder:"Select",modelValue:s(D),"onUpdate:modelValue":o[3]||(o[3]=t=>P(D)?D.value=t:null),label:"Unidades"},null,8,["items","modelValue"])]),_:1}),l(d,{cols:"3"},{default:e(()=>[l(O,{items:s(h),"item-title":"name","item-value":"id",placeholder:"Select",label:"Sucursales",modelValue:s(C),"onUpdate:modelValue":o[4]||(o[4]=t=>P(C)?C.value=t:null)},null,8,["items","modelValue"])]),_:1}),l(d,{cols:"3"},{default:e(()=>[l(O,{placeholder:"Select",label:"Disponibilidad",items:[{id:1,title:"Vender sin Stock"},{id:2,title:"No Vender sin Stock"}],"item-title":"title","item-value":"id",modelValue:s(I),"onUpdate:modelValue":o[5]||(o[5]=t=>P(I)?I.value=t:null)},null,8,["modelValue"])]),_:1}),l(d,{cols:"2"},{default:e(()=>[l(O,{placeholder:"Â¿Regalo?",label:"Â¿Regalo?",items:[{id:1,title:"NO"},{id:2,title:"SI"}],"item-title":"title","item-value":"id",modelValue:s(A),"onUpdate:modelValue":o[6]||(o[6]=t=>P(A)?A.value=t:null)},null,8,["modelValue"])]),_:1}),l(d,{cols:"4"},{default:e(()=>[l(S,{color:"info",class:"mx-1","prepend-icon":"ri-search-2-line",onClick:o[7]||(o[7]=t=>T())},{default:e(()=>[l(z,{activator:"parent",location:"top"},{default:e(()=>[n(" Buscar ")]),_:1})]),_:1}),l(S,{color:"secondary",class:"mx-1","prepend-icon":"ri-restart-line",onClick:o[8]||(o[8]=t=>ee())},{default:e(()=>[l(z,{activator:"parent",location:"top"},{default:e(()=>[n(" Limpieza ")]),_:1})]),_:1}),l(S,{color:"success",class:"mx-1","prepend-icon":"ri-file-excel-2-line",onClick:o[9]||(o[9]=t=>te())},{default:e(()=>[l(z,{activator:"parent",location:"top"},{default:e(()=>[n(" Exportar Productos ")]),_:1})]),_:1}),l(S,{color:"success",class:"mx-1","prepend-icon":"ri-file-excel-line",onClick:o[10]||(o[10]=t=>b.value=!s(b))},{default:e(()=>[l(z,{activator:"parent",location:"top"},{default:e(()=>[n(" Importar Productos ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(d,{cols:"2",class:"text-end"},{default:e(()=>[("isPermission"in a?a.isPermission:s(q))("register_product")?(u(),p(S,{key:0,onClick:o[11]||(o[11]=t=>s(U).push({name:"product-add"}))},{default:e(()=>[n(" AÃ±adir Producto "),l(K,{end:"",icon:"ri-add-line"})]),_:1})):v("",!0)]),_:1})]),_:1})]),_:1}),l(be,null,{default:e(()=>[Se,r("tbody",null,[(u(!0),B(me,null,fe(s(f),t=>(u(),B("tr",{key:t.id},[r("td",null,[r("div",we,[l(xe,{size:"32",color:t.imagen?"":"primary",class:_e(t.imagen?"":"v-avatar-light-bg primary--text"),variant:t.imagen?void 0:"tonal"},{default:e(()=>[t.imagen?(u(),p(ye,{key:0,src:t.imagen},null,8,["src"])):(u(),B("span",Ie,m(ie(t.title)),1))]),_:2},1032,["color","class","variant"]),r("div",Ae,m(t.title),1)]),t.state_stock==1?(u(),p(N,{key:0,color:"primary"},{default:e(()=>[n(" DISPONIBLE ")]),_:1})):v("",!0),t.state_stock==2?(u(),p(N,{key:1,color:"warning"},{default:e(()=>[n(" POR AGOTAR ")]),_:1})):v("",!0),t.state_stock==3?(u(),p(N,{key:2,color:"error"},{default:e(()=>[n(" AGOTADO ")]),_:1})):v("",!0)]),r("td",null,m(t.sku),1),r("td",null,m(t.product_categorie.name),1),r("td",null,m(t.is_gift==1?"NO":"SI"),1),r("td",null,[n(m(t.is_discount==1?"NO":"SI")+" ",1),Ue,t.is_discount==2?(u(),B("span",Re,"Descuento: "+m(t.max_discount)+" %",1)):v("",!0)]),r("td",null,m(t.importe_iva),1),r("td",null,m(t.warranty_day)+" dias ",1),r("td",null,[t.state==1?(u(),p(N,{key:0,color:"primary"},{default:e(()=>[n(" Activo ")]),_:1})):v("",!0),t.state==2?(u(),p(N,{key:1,color:"error"},{default:e(()=>[n(" Inactivo ")]),_:1})):v("",!0)]),r("td",null,m(t.created_at),1),r("td",null,[r("div",Te,[("isPermission"in a?a.isPermission:s(q))("edit_product")?(u(),p(E,{key:0,size:"small",onClick:ne=>se(t)},{default:e(()=>[l(K,{icon:"ri-pencil-line"})]),_:2},1032,["onClick"])):v("",!0),("isPermission"in a?a.isPermission:s(q))("delete_product")?(u(),p(E,{key:1,size:"small",onClick:ne=>re(t)},{default:e(()=>[l(K,{icon:"ri-delete-bin-line"})]),_:2},1032,["onClick"])):v("",!0)])])]))),128))])]),_:1}),l(ke,{modelValue:s(_),"onUpdate:modelValue":o[12]||(o[12]=t=>P(_)?_.value=t:null),length:s(x)},null,8,["modelValue","length"])]),_:1}),l(G,{isDialogVisible:s(b),"onUpdate:isDialogVisible":o[13]||(o[13]=t=>P(b)?b.value=t:null),onImportExcelProduct:o[14]||(o[14]=t=>oe())},null,8,["isDialogVisible"]),s(M)&&s(g)?(u(),p(ue,{key:0,isDialogVisible:s(g),"onUpdate:isDialogVisible":o[15]||(o[15]=t=>P(g)?g.value=t:null),productSelected:s(M),onDeleteProduct:ae},null,8,["isDialogVisible","productSelected"])):v("",!0)])}}};export{nl as default};
