import{$ as N}from"./api-DxrbhZSf.js";import{V as R}from"./VCardText-D-w9kZpv.js";import{V as C,a as h}from"./VRow-f7OHVuKd.js";import{V as q}from"./VSelect-CLTqdzaG.js";import{V as K}from"./VAutocomplete-CwHZXTr4.js";import{V as Q}from"./VAlert-ELbKA5bW.js";import{r as p,x as A,o as Y,h as r,a as u,b as o,w as s,i as g,u as c,c as $,f as B,g as y,t as e,V as L,F as i,j as w,d as l}from"./index-W4kja-31.js";import{V as j}from"./VTooltip-DOtX7Pla.js";import{V as W}from"./VCard-CrSgQsdG.js";import"./index-BYrzgnBV.js";import"./VAvatar-D-KF6a6N.js";import"./VImg-BXz4PYAy.js";/* empty css              */import"./VTextField-DIHLaahk.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-DFWg69W8.js";import"./VDivider-D7rU52Ox.js";import"./VOverlay-DsWRzxlS.js";import"./VMenu-HxKMt7sI.js";import"./VCheckboxBtn-D15mcKdF.js";import"./VChip-6YKG-Q6j.js";import"./filter-CbKp_48J.js";const X=l("br",null,null,-1),Z=l("br",null,null,-1),ll=l("tr",null,[l("th",{rowspan:"1",colspan:"2"}),l("th",{colspan:"3",class:"entrada"},"Entrada"),l("th",{colspan:"3",class:"salida"},"Salida"),l("th",{colspan:"3",class:"existencias"},"Existencias")],-1),tl=l("th",{rowspan:"2"},"Fecha",-1),el=l("th",{rowspan:"2"},"Detalle",-1),al={colspan:"9",class:"subheader"},nl=l("tr",null,[l("th",null,"Cantidad"),l("th",null,"V/Unitario"),l("th",null,"V/Total"),l("th",null,"Cantidad"),l("th",null,"V/Unitario"),l("th",null,"V/Total"),l("th",null,"Cantidad"),l("th",null,"V/Unitario"),l("th",null,"V/Total")],-1),ol=l("td",null,null,-1),sl=l("td",null,null,-1),ul=l("td",null,null,-1),rl=l("td",null,null,-1),dl=l("td",null,null,-1),il=l("td",null,null,-1),cl={class:"new-row"},_l=l("td",{colspan:"2"},null,-1),pl={colspan:"9"},hl=l("tr",{class:"new-row"},[l("td",null,[l("b",null,"Fecha")]),l("td",null,[l("b",null,"Detalle")]),l("td",null,[l("b",null,"Cantidad")]),l("td",null,[l("b",null,"V/Unitario")]),l("td",null,[l("b",null,"V/Total")]),l("td",null,[l("b",null,"Cantidad")]),l("td",null,[l("b",null,"V/Unitario")]),l("td",null,[l("b",null,"V/Total")]),l("td",null,[l("b",null,"Cantidad")]),l("td",null,[l("b",null,"V/Unitario")]),l("td",null,[l("b",null,"V/Total")])],-1),ml=l("td",null,null,-1),fl=l("td",null,null,-1),Vl=l("td",null,null,-1),yl=l("td",null,null,-1),bl=l("td",null,null,-1),gl=l("td",null,null,-1),Jl={__name:"index",setup(wl){const F=p([]),b=p(null),z=p([{id:"01",name:"Enero"},{id:"02",name:"Febrero"},{id:"03",name:"Marzo"},{id:"04",name:"Abril"},{id:"05",name:"Mayo"},{id:"06",name:"Junio"},{id:"07",name:"Julio"},{id:"08",name:"Agosto"},{id:"09",name:"Septiembre"},{id:"10",name:"Octubre"},{id:"11",name:"Noviembre"},{id:"12",name:"Diciembre"}]),G=p(["2025","2026","2027","2028","2029","2030"]),k=p(new Date().getMonth()+1<=9?"0"+(new Date().getMonth()+1):new Date().getMonth()+1+""),x=p(new Date().getFullYear()+""),M=p([]),_=d=>{const a=Number(d??0);try{return new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(a)}catch{return`${a.toLocaleString("es-ES")} â‚¬`}},E=p(!1),m=p(),f=p(null),T=p([]),S=p(null),I=d=>{E.value=!0,setTimeout(async()=>{try{const a=await N("sales/search_product?search="+(m.value?m.value:""),{method:"GET",onResponseError({response:t}){console.log(t._data.error)}});T.value=a.products.data,E.value=!1}catch(a){console.log(a)}},500)};A(m,d=>{S.value=null,(d||"").length>3?I():T.value=[]}),A(f,d=>{});const J=async()=>{try{const d=await N("transports/config",{method:"GET",onResponseError({response:a}){console.log(a._data.error)}});F.value=d.warehouses}catch(d){console.log(d)}},O=async()=>{try{const d={year:x.value,month:k.value,warehouse_id:b.value,product_id:f.value?f.value.id:null},a=await N("kardex_products",{method:"POST",body:d,onResponseError({response:t}){console.log(t._data.error)}});M.value=a.kardex_products}catch(d){console.log(d)}},P=()=>{b.value="",f.value=null,m.value=""},H=(d,a)=>{const t=a.find(U=>U.id==d.unit_id);return t?t.name:""};return Y(()=>{J()}),(d,a)=>(u(),r("div",null,[o(W,{title:"ðŸ“’ Reporte Kardex"},{default:s(()=>[o(R,null,{default:s(()=>[o(C,null,{default:s(()=>[o(h,{cols:"12"},{default:s(()=>[o(C,null,{default:s(()=>[o(h,{cols:"2"},{default:s(()=>[o(q,{items:c(G),placeholder:"Selecciona",modelValue:c(x),"onUpdate:modelValue":a[0]||(a[0]=t=>g(x)?x.value=t:null),label:"AÃ±o"},null,8,["items","modelValue"])]),_:1}),o(h,{cols:"2"},{default:s(()=>[o(q,{items:c(z),"item-title":"name","item-value":"id",placeholder:"Selecciona",modelValue:c(k),"onUpdate:modelValue":a[1]||(a[1]=t=>g(k)?k.value=t:null),label:"Mes"},null,8,["items","modelValue"])]),_:1}),o(h,{cols:"2"},{default:s(()=>[o(q,{items:c(F),"item-title":"name","item-value":"id",placeholder:"Selecciona",modelValue:c(b),"onUpdate:modelValue":a[2]||(a[2]=t=>g(b)?b.value=t:null),label:"Almacenes"},null,8,["items","modelValue"])]),_:1}),o(h,{cols:"4"},{default:s(()=>[o(C,null,{default:s(()=>[o(h,{cols:"12"},{default:s(()=>[o(K,{modelValue:c(f),"onUpdate:modelValue":a[3]||(a[3]=t=>g(f)?f.value=t:null),search:c(m),"onUpdate:search":a[4]||(a[4]=t=>g(m)?m.value=t:null),loading:c(E),items:c(T),"item-title":"title","item-value":"id","return-object":"",placeholder:"Buscar producto",label:"Â¿QuÃ© agregamos?",variant:"underlined","menu-props":{maxHeight:"200px"}},null,8,["modelValue","search","loading","items"])]),_:1}),c(S)?(u(),$(h,{key:0,cols:"12"},{default:s(()=>[o(Q,{closable:"","close-label":"Cerrar",color:"warning"},{default:s(()=>[y(e(c(S)),1)]),_:1})]),_:1})):B("",!0)]),_:1})]),_:1}),o(h,{cols:"2"},{default:s(()=>[o(L,{color:"info",class:"mx-1","prepend-icon":"ri-search-2-line",onClick:a[5]||(a[5]=t=>O())},{default:s(()=>[o(j,{activator:"parent",location:"top"},{default:s(()=>[y("Buscar")]),_:1})]),_:1}),o(L,{color:"secondary",class:"mx-1","prepend-icon":"ri-restart-line",onClick:a[6]||(a[6]=t=>P())},{default:s(()=>[o(j,{activator:"parent",location:"top"},{default:s(()=>[y("Limpieza")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(R,{class:"kardex"},{default:s(()=>[(u(!0),r(i,null,w(c(M),(t,U)=>(u(),$(C,{key:U},{default:s(()=>[o(h,{cols:"12"},{default:s(()=>[y(" Producto: "+e(t.title),1),X,y(" Sku: "+e(t.sku),1),Z,y(" CategorÃ­a: "+e(t.categoria),1)]),_:2},1024),o(h,{cols:"12"},{default:s(()=>[l("table",null,[l("thead",null,[ll,l("tr",null,[tl,el,l("th",al,e(t.unit_first.name),1)]),nl]),l("tbody",null,[(u(!0),r(i,null,w(t.movimient_for_units,(V,v)=>(u(),r(i,{key:v},[t.unit_first.id==V.unit_id?(u(!0),r(i,{key:0},w(V.movimients,(n,D)=>(u(),r("tr",{key:D},[l("td",null,e(n.fecha),1),l("td",null,e(n.detalle),1),n.entrada?(u(),r(i,{key:0},[l("td",null,e(n.entrada.quantity),1),l("td",null,e(_(n.entrada.price_unit)),1),l("td",null,e(_(n.entrada.total)),1)],64)):(u(),r(i,{key:1},[ol,sl,ul],64)),n.salida?(u(),r(i,{key:2},[l("td",null,e(n.salida.quantity),1),l("td",null,e(_(n.salida.price_unit)),1),l("td",null,e(_(n.salida.total)),1)],64)):(u(),r(i,{key:3},[rl,dl,il],64)),l("td",null,e(n.existencia.quantity),1),l("td",null,e(_(n.existencia.price_unit)),1),l("td",null,e(_(n.existencia.total)),1)]))),128)):B("",!0)],64))),128)),(u(!0),r(i,null,w(t.movimient_for_units,(V,v)=>(u(),r(i,{key:v},[t.unit_first.id!=V.unit_id?(u(),r(i,{key:0},[l("tr",cl,[_l,l("td",pl,[l("b",null,e(H(V,t.units)),1)])]),hl,(u(!0),r(i,null,w(V.movimients,(n,D)=>(u(),r("tr",{key:D},[l("td",null,e(n.fecha),1),l("td",null,e(n.detalle),1),n.entrada?(u(),r(i,{key:0},[l("td",null,e(n.entrada.quantity),1),l("td",null,e(_(n.entrada.price_unit)),1),l("td",null,e(_(n.entrada.total)),1)],64)):(u(),r(i,{key:1},[ml,fl,Vl],64)),n.salida?(u(),r(i,{key:2},[l("td",null,e(n.salida.quantity),1),l("td",null,e(_(n.salida.price_unit)),1),l("td",null,e(_(n.salida.total)),1)],64)):(u(),r(i,{key:3},[yl,bl,gl],64)),l("td",null,e(n.existencia.quantity),1),l("td",null,e(_(n.existencia.price_unit)),1),l("td",null,e(_(n.existencia.total)),1)]))),128))],64)):B("",!0)],64))),128))])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))}};export{Jl as default};
