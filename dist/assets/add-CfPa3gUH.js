import{_ as ve}from"./IconBtn-BnO4JjSS.js";import{_ as Ve}from"./TiptapEditor-BoVmCIl9.js";import{r,aJ as ge,aK as ee,aL as be,o as ye,h as V,a as m,b as e,w as a,u as o,g as f,c as $,f as M,t as p,d as i,l as Z,V as z,F as G,j as H,e as le,i as C,Q as xe,R as ke}from"./index-W4kja-31.js";import{$ as ae}from"./api-DxrbhZSf.js";import{_ as Se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as n,V as q}from"./VRow-f7OHVuKd.js";import{V as L,a as he,d as Ce}from"./VCard-CrSgQsdG.js";import{V as g}from"./VCardText-D-w9kZpv.js";import{V as _,a as Te}from"./VTextField-DIHLaahk.js";import{V as K}from"./VAlert-ELbKA5bW.js";import{V as Ue}from"./VAvatar-D-KF6a6N.js";import{V as Ee}from"./VImg-BXz4PYAy.js";import{V as b}from"./VSelect-CLTqdzaG.js";import{V as te}from"./VTable-Cddsam7K.js";import{V as oe}from"./VCheckbox-D0DXs1MP.js";import"./VDivider-D7rU52Ox.js";import"./index-BYrzgnBV.js";/* empty css              */import"./forwardRefs-DWGaNmQL.js";import"./VList-DFWg69W8.js";import"./VOverlay-DsWRzxlS.js";import"./VMenu-HxKMt7sI.js";import"./VCheckboxBtn-D15mcKdF.js";import"./VChip-6YKG-Q6j.js";const T=O=>(xe("data-v-25cb7186"),O=O(),ke(),O),we=T(()=>i("div",{class:"d-flex flex-wrap justify-space-between gap-4 mb-6"},[i("div",{class:"d-flex flex-column justify-center"},[i("h4",{class:"text-h4 mb-1"},"üíª A√±adir Nuevo Producto"),i("p",{class:"text-body-1 mb-0"})])],-1)),Ie=T(()=>i("h6",{class:"text-h6 text-primary cursor-pointer"},"A√±adir multimedia desde URL",-1)),Ne={class:"flex"},Ae={class:"w-full h-auto relative"},Le={key:0,class:"d-flex flex-column justify-center align-center gap-y-2 pa-12 border-dashed drop-zone"},De=T(()=>i("h4",{class:"text-h4 text-wrap"},"Arrastra y suelta tu imagen aqu√≠",-1)),Pe=T(()=>i("span",{class:"text-disabled"},"o",-1)),Re={key:1,class:"d-flex justify-center align-center gap-3 pa-8 border-dashed drop-zone flex-wrap"},$e={class:"mt-2"},Me={class:"clamp-text text-wrap"},qe=T(()=>i("thead",null,[i("tr",null,[i("th",{class:"text-uppercase"},"Almac√©n"),i("th",{class:"text-uppercase"},"Unidad"),i("th",{class:"text-uppercase"},"Stock"),i("th",{class:"text-uppercase"},"Stock m√≠nimo"),i("th",{class:"text-uppercase"},"Acci√≥n")])],-1)),je={class:"d-flex gap-1"},Be=T(()=>i("thead",null,[i("tr",null,[i("th",{class:"text-uppercase"},"Sucursal"),i("th",{class:"text-uppercase"},"Unidad"),i("th",{class:"text-uppercase"},"Tipo de cliente"),i("th",{class:"text-uppercase"},"Precio"),i("th",{class:"text-uppercase"},"Acci√≥n")])],-1)),ze={class:"d-flex flex-column gap-y-5"},Ke=T(()=>i("p",{class:"my-0"},"¬øRegalo?",-1)),Oe={class:"d-flex"},Ye=T(()=>i("p",{class:"my-0"},"¬øTiene descuento?",-1)),Fe={key:0,class:"ml-5"},Je={class:"d-flex flex-column gap-y-5"},Ze={__name:"add",setup(O){const Q=r(),v=r([]),{open:ue,onChange:ie}=ge({accept:"image/*",multiple:!1});function se(s){s==null||s.forEach(l=>{if(l.type.slice(0,6)!=="image/"){alert("Solo se permiten im√°genes");return}v.value.push({file:l,url:ee(l).value??""})})}ie(s=>{if(v.value.length===1){alert("Solo se permite una imagen");return}if(s)for(const l of s)v.value.push({file:l,url:ee(l).value??""})}),be(Q,se);const W=r([]),F=r([]),j=r([]),J=r([]),u=r({title:"",sku:"",price_general:0,price_company:0,description:"",product_categorie_id:"",is_gift:1,is_discount:1,max_discount:0,tax_selected:1,importe_iva:18,disponibilidad:1,state:1,warranty_day:30}),y=r(null),x=r(null),D=r(0),B=r(0),U=r(null),k=r(null),S=r(null),P=r(0),E=r([]),w=r([]),I=r(null),N=r(null),c=r(null),R=r(null),Y=r(null),ne=s=>{const l=Number(s??0);try{return new Intl.NumberFormat("es-ES",{style:"currency",currency:"EUR"}).format(l)}catch{return`${l.toLocaleString("es-ES")} ‚Ç¨`}},re=async()=>{try{const s=await ae("products/config",{method:"GET",onResponseError({response:l}){console.log(l._data.error)}});W.value=s.categories,F.value=s.sucursales,j.value=s.units,J.value=s.warehouses}catch(s){console.log(s)}},de=()=>{if(I.value=null,!y.value){setTimeout(()=>I.value="Necesitas seleccionar un almac√©n",25);return}if(!x.value){setTimeout(()=>I.value="Necesitas seleccionar una unidad",25);return}if(D.value<=0){setTimeout(()=>I.value="Necesitas ingresar un stock mayor a 0",25);return}if(E.value.find(d=>d.warehouse_id===y.value&&d.unit_id===x.value)){I.value="Esta existencia ya existe, agrega una nueva";return}const l=J.value.find(d=>d.id===y.value),A=j.value.find(d=>d.id===x.value);E.value.unshift({warehouse_id:y.value,warehouse:l,unit_id:x.value,unit:A,stock:D.value,umbral:B.value}),setTimeout(()=>{y.value="",x.value="",D.value=0,B.value=0},25)},ce=s=>E.value.splice(s,1),me=()=>{if(N.value=null,!k.value){setTimeout(()=>N.value="Necesitas seleccionar una unidad",25);return}if(!S.value){setTimeout(()=>N.value="Necesitas seleccionar un tipo de cliente",25);return}if(P.value<=0){setTimeout(()=>N.value="Necesitas ingresar un precio mayor a 0",25);return}if(w.value.find(d=>d.sucursale_id===U.value&&d.unit_id===k.value&&d.type_client===S.value)){N.value="Ya existe esta configuraci√≥n de precio, selecciona otra";return}const l=F.value.find(d=>d.id===U.value),A=j.value.find(d=>d.id===k.value);w.value.unshift({type_client:S.value,type_client_name:S.value===1?"Cliente final":"Cliente empresa",unit_id:k.value,unit:A,sucursale_id:U.value,sucursale:l,price:Number(P.value)}),setTimeout(()=>{S.value="",k.value="",U.value=null,P.value=0},25)},pe=s=>w.value.splice(s,1),fe=async()=>{try{if(c.value=null,R.value=null,Y.value=null,!u.value.title){setTimeout(()=>c.value="Es requerido ingresar un nombre al producto",15);return}if(!u.value.sku){setTimeout(()=>c.value="Es requerido ingresar el SKU del producto",15);return}if(!u.value.price_general){setTimeout(()=>c.value="Es requerido ingresar el precio general del producto",15);return}if(!u.value.price_company){setTimeout(()=>c.value="Es requerido ingresar el precio de tipo empresa",15);return}if(!u.value.description){setTimeout(()=>c.value="Es requerido ingresar una descripci√≥n",15);return}if(!u.value.product_categorie_id){setTimeout(()=>c.value="Es requerida la categor√≠a del producto",15);return}if(u.value.importe_iva<0){setTimeout(()=>c.value="El IVA debe ser mayor o igual a 0",15);return}if(u.value.warranty_day<0){setTimeout(()=>c.value="Los d√≠as de garant√≠a deben ser ‚â• 0",15);return}if(v.value.length===0){setTimeout(()=>c.value="Es requerida una imagen del producto",15);return}if(u.value.is_discount==2&&u.value.max_discount<=0){setTimeout(()=>c.value="Debes indicar el % de descuento m√°ximo",15);return}if(E.value.length===0){setTimeout(()=>c.value="Agrega al menos una existencia inicial",15);return}if(w.value.length===0){setTimeout(()=>c.value="Agrega al menos un precio m√∫ltiple",15);return}const s=new FormData;s.append("title",u.value.title),s.append("sku",u.value.sku),s.append("price_general",u.value.price_general),s.append("price_company",u.value.price_company),s.append("description",u.value.description),s.append("product_categorie_id",u.value.product_categorie_id),s.append("image",v.value[0].file),s.append("product_warehouses",JSON.stringify(E.value)),s.append("product_wallets",JSON.stringify(w.value)),s.append("is_gift",u.value.is_gift==!1?1:u.value.is_gift),s.append("is_discount",u.value.is_discount==!1?1:u.value.is_discount),u.value.is_discount==2&&s.append("max_discount",u.value.max_discount),s.append("tax_selected",u.value.tax_selected),s.append("importe_iva",u.value.importe_iva),s.append("warranty_day",u.value.warranty_day),s.append("disponibilidad",u.value.disponibilidad),s.append("state",u.value.state);const l=await ae("products",{method:"POST",body:s,onResponseError({response:A}){R.value=A._data.error}});l.message==403?R.value=l.message_text:(Y.value="El producto se ha registrado correctamente",_e(),c.value=null,R.value=null)}catch(s){console.log(s)}},_e=()=>{u.value={title:"",sku:"",price_general:0,price_company:0,description:"",product_categorie_id:"",is_gift:1,is_discount:1,max_discount:0,tax_selected:1,importe_iva:18,disponibilidad:1,state:1,warranty_day:30},w.value=[],E.value=[],v.value=[]};return ye(()=>{re()}),(s,l)=>{const A=Ve,d=ve;return m(),V("div",null,[we,e(q,null,{default:a(()=>[e(n,{md:"8"},{default:a(()=>[e(L,{class:"mb-6",title:"Informaci√≥n del producto"},{default:a(()=>[e(g,null,{default:a(()=>[e(q,null,{default:a(()=>[e(n,{cols:"12"},{default:a(()=>[e(_,{label:"Nombre del producto",modelValue:o(u).title,"onUpdate:modelValue":l[0]||(l[0]=t=>o(u).title=t),placeholder:"iPhone 14"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"4"},{default:a(()=>[e(_,{label:"SKU",modelValue:o(u).sku,"onUpdate:modelValue":l[1]||(l[1]=t=>o(u).sku=t),placeholder:"FXSK123U"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"4"},{default:a(()=>[e(_,{label:"Precio (Cliente final)",modelValue:o(u).price_general,"onUpdate:modelValue":l[2]||(l[2]=t=>o(u).price_general=t),modelModifiers:{number:!0},type:"number",inputmode:"decimal",step:"0.01",prefix:"‚Ç¨",placeholder:"50,00"},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"4"},{default:a(()=>[e(_,{label:"Precio (Cliente empresa)",modelValue:o(u).price_company,"onUpdate:modelValue":l[3]||(l[3]=t=>o(u).price_company=t),modelModifiers:{number:!0},type:"number",inputmode:"decimal",step:"0.01",prefix:"‚Ç¨",placeholder:"100,00"},null,8,["modelValue"])]),_:1}),e(n,null,{default:a(()=>[e(Te,{class:"mb-1"},{default:a(()=>[f("Descripci√≥n")]),_:1}),e(A,{modelValue:o(u).description,"onUpdate:modelValue":l[4]||(l[4]=t=>o(u).description=t),class:"border rounded-lg"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(q,null,{default:a(()=>[o(c)?(m(),$(n,{key:0,cols:"12"},{default:a(()=>[e(K,{closable:"","close-label":"Cerrar alerta",color:"warning"},{default:a(()=>[f(p(o(c)),1)]),_:1})]),_:1})):M("",!0),o(R)?(m(),$(n,{key:1,cols:"12"},{default:a(()=>[e(K,{closable:"","close-label":"Cerrar alerta",color:"error"},{default:a(()=>[f(p(o(R)),1)]),_:1})]),_:1})):M("",!0),o(Y)?(m(),$(n,{key:2,cols:"12"},{default:a(()=>[e(K,{closable:"","close-label":"Cerrar alerta",color:"success"},{default:a(()=>[f(p(o(Y)),1)]),_:1})]),_:1})):M("",!0)]),_:1}),e(L,{class:"my-6"},{default:a(()=>[e(he,null,{title:a(()=>[f("Imagen del producto")]),append:a(()=>[Ie]),_:1}),e(g,null,{default:a(()=>[i("div",Ne,[i("div",Ae,[i("div",{ref_key:"dropZoneRef",ref:Q,class:"cursor-pointer",onClick:l[6]||(l[6]=()=>o(ue)())},[o(v).length===0?(m(),V("div",Le,[e(Ue,{variant:"tonal",color:"secondary",rounded:""},{default:a(()=>[e(Z,{icon:"ri-upload-2-line"})]),_:1}),De,Pe,e(z,{variant:"outlined",size:"small"},{default:a(()=>[f("Seleccionar im√°genes")]),_:1})])):(m(),V("div",Re,[e(q,{class:"match-height w-100"},{default:a(()=>[(m(!0),V(G,null,H(o(v),(t,h)=>(m(),$(n,{key:h,cols:"12",sm:"4"},{default:a(()=>[e(L,{ripple:!1},{default:a(()=>[e(g,{class:"d-flex flex-column",onClick:l[5]||(l[5]=le(()=>{},["stop"]))},{default:a(()=>[e(Ee,{src:t.url,width:"200px",height:"150px",class:"w-100 mx-auto"},null,8,["src"]),i("div",$e,[i("span",Me,p(t.file.name),1),i("span",null,p(t.file.size/1e3)+" KB",1)])]),_:2},1024),e(Ce,null,{default:a(()=>[e(z,{variant:"text",block:"",onClick:le(X=>o(v).splice(h,1),["stop"])},{default:a(()=>[f("Eliminar archivo")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]))],512)])])]),_:1})]),_:1}),e(L,{title:"Existencias",class:"mb-6"},{default:a(()=>[e(g,null,{default:a(()=>[e(q,null,{default:a(()=>[e(n,{cols:"3",md:"3"},{default:a(()=>[e(b,{items:o(J),"item-title":"name","item-value":"id",placeholder:"Seleccionar",modelValue:o(y),"onUpdate:modelValue":l[7]||(l[7]=t=>C(y)?y.value=t:null),label:"Almacenes"},null,8,["items","modelValue"])]),_:1}),e(n,{cols:"3",md:"3"},{default:a(()=>[e(b,{items:o(j),"item-title":"name","item-value":"id",placeholder:"Seleccionar",modelValue:o(x),"onUpdate:modelValue":l[8]||(l[8]=t=>C(x)?x.value=t:null),label:"Unidades"},null,8,["items","modelValue"])]),_:1}),e(n,{cols:"3",md:"3"},{default:a(()=>[e(_,{label:"Stock",type:"number",modelValue:o(D),"onUpdate:modelValue":l[9]||(l[9]=t=>C(D)?D.value=t:null)},null,8,["modelValue"])]),_:1}),e(n,{cols:"2",md:"2"},{default:a(()=>[e(_,{label:"Stock m√≠nimo",type:"number",modelValue:o(B),"onUpdate:modelValue":l[10]||(l[10]=t=>C(B)?B.value=t:null)},null,8,["modelValue"])]),_:1}),e(n,{cols:"1",md:"1"},{default:a(()=>[e(z,{"prepend-icon":"ri-add-line",onClick:l[11]||(l[11]=t=>de())})]),_:1}),o(I)?(m(),$(n,{key:0,cols:"12"},{default:a(()=>[e(K,{closable:"","close-label":"Cerrar alerta",color:"warning"},{default:a(()=>[f(p(o(I)),1)]),_:1})]),_:1})):M("",!0)]),_:1})]),_:1}),e(g,null,{default:a(()=>[e(te,null,{default:a(()=>[qe,i("tbody",null,[(m(!0),V(G,null,H(o(E),(t,h)=>(m(),V("tr",{key:h},[i("td",null,p(t.warehouse.name),1),i("td",null,p(t.unit.name),1),i("td",null,p(t.stock),1),i("td",null,p(t.umbral),1),i("td",null,[i("div",je,[e(d,{size:"small",onClick:X=>ce(h)},{default:a(()=>[e(Z,{icon:"ri-delete-bin-line"})]),_:2},1032,["onClick"])])])]))),128))])]),_:1})]),_:1})]),_:1}),e(L,{title:"M√∫ltiples precios",class:"mb-6"},{default:a(()=>[e(g,null,{default:a(()=>[e(q,null,{default:a(()=>[e(n,{cols:"4",md:"3"},{default:a(()=>[e(b,{items:o(F),"item-title":"name","item-value":"id",placeholder:"Seleccionar",label:"Sucursales",modelValue:o(U),"onUpdate:modelValue":l[12]||(l[12]=t=>C(U)?U.value=t:null)},null,8,["items","modelValue"])]),_:1}),e(n,{cols:"4",md:"3"},{default:a(()=>[e(b,{items:o(j),"item-title":"name","item-value":"id",placeholder:"Seleccionar",label:"Unidades",modelValue:o(k),"onUpdate:modelValue":l[13]||(l[13]=t=>C(k)?k.value=t:null)},null,8,["items","modelValue"])]),_:1}),e(n,{cols:"4",md:"3"},{default:a(()=>[e(b,{items:[{id:1,name:"Cliente final"},{id:2,name:"Cliente empresa"}],"item-title":"name","item-value":"id",placeholder:"Seleccionar",label:"Tipo de cliente",modelValue:o(S),"onUpdate:modelValue":l[14]||(l[14]=t=>C(S)?S.value=t:null)},null,8,["modelValue"])]),_:1}),e(n,{cols:"3",md:"2"},{default:a(()=>[e(_,{label:"Precio",type:"number",inputmode:"decimal",step:"0.01",prefix:"‚Ç¨",modelValue:o(P),"onUpdate:modelValue":l[15]||(l[15]=t=>C(P)?P.value=t:null),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1}),e(n,{cols:"1",md:"1"},{default:a(()=>[e(z,{"prepend-icon":"ri-add-line",onClick:l[16]||(l[16]=t=>me())})]),_:1}),o(N)?(m(),$(n,{key:0,cols:"12"},{default:a(()=>[e(K,{closable:"","close-label":"Cerrar alerta",color:"warning"},{default:a(()=>[f(p(o(N)),1)]),_:1})]),_:1})):M("",!0)]),_:1})]),_:1}),e(g,null,{default:a(()=>[e(te,null,{default:a(()=>[Be,i("tbody",null,[(m(!0),V(G,null,H(o(w),(t,h)=>(m(),V("tr",{key:h},[i("td",null,p(t.sucursale?t.sucursale.name:"---"),1),i("td",null,p(t.unit.name),1),i("td",null,p(t.type_client_name),1),i("td",null,p(ne(t.price)),1),i("td",null,[e(d,{size:"small",onClick:X=>pe(h)},{default:a(()=>[e(Z,{icon:"ri-delete-bin-line"})]),_:2},1032,["onClick"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),e(n,{md:"4",cols:"12"},{default:a(()=>[e(L,{title:"Adicionales"},{default:a(()=>[e(g,null,{default:a(()=>[i("div",ze,[e(b,{placeholder:"Seleccionar",label:"Categor√≠a",items:o(W),"item-title":"name","item-value":"id",modelValue:o(u).product_categorie_id,"onUpdate:modelValue":l[17]||(l[17]=t=>o(u).product_categorie_id=t)},null,8,["items","modelValue"]),i("div",null,[Ke,e(oe,{label:"S√≠",value:"2",modelValue:o(u).is_gift,"onUpdate:modelValue":l[18]||(l[18]=t=>o(u).is_gift=t)},null,8,["modelValue"])]),i("div",Oe,[i("div",null,[Ye,e(oe,{label:"S√≠",value:"2",modelValue:o(u).is_discount,"onUpdate:modelValue":l[19]||(l[19]=t=>o(u).is_discount=t)},null,8,["modelValue"])]),o(u).is_discount==2?(m(),V("div",Fe,[e(_,{label:"% de descuento m√°ximo",type:"number",modelValue:o(u).max_discount,"onUpdate:modelValue":l[20]||(l[20]=t=>o(u).max_discount=t),modelModifiers:{number:!0},placeholder:"18",suffix:"%"},null,8,["modelValue"])])):M("",!0)]),e(_,{label:"D√≠as de garant√≠a",type:"number",modelValue:o(u).warranty_day,"onUpdate:modelValue":l[21]||(l[21]=t=>o(u).warranty_day=t),modelModifiers:{number:!0},placeholder:"30"},null,8,["modelValue"])])]),_:1})]),_:1}),e(L,{title:"Especificaciones",class:"my-5"},{default:a(()=>[e(g,null,{default:a(()=>[i("div",Je,[e(b,{placeholder:"Seleccionar",label:"Tipo de impuesto",items:[{id:1,title:"Sujeto a impuesto"},{id:2,title:"Libre de impuesto"}],"item-title":"title","item-value":"id",modelValue:o(u).tax_selected,"onUpdate:modelValue":l[22]||(l[22]=t=>o(u).tax_selected=t)},null,8,["modelValue"]),e(_,{label:"IVA",type:"number",modelValue:o(u).importe_iva,"onUpdate:modelValue":l[23]||(l[23]=t=>o(u).importe_iva=t),modelModifiers:{number:!0},placeholder:"21",suffix:"%"},null,8,["modelValue"]),e(b,{placeholder:"Seleccionar",label:"Disponibilidad",items:[{id:1,title:"Vender sin stock"},{id:2,title:"No vender sin stock"}],"item-title":"title","item-value":"id",modelValue:o(u).disponibilidad,"onUpdate:modelValue":l[24]||(l[24]=t=>o(u).disponibilidad=t)},null,8,["modelValue"]),e(b,{placeholder:"Seleccionar",label:"Estado",items:[{id:1,name:"Activo"},{id:2,name:"Inactivo"}],"item-title":"name","item-value":"id",modelValue:o(u).state,"onUpdate:modelValue":l[25]||(l[25]=t=>o(u).state=t)},null,8,["modelValue"])])]),_:1})]),_:1}),e(z,{block:"",onClick:fe},{default:a(()=>[f("Crear producto")]),_:1})]),_:1})]),_:1})])}}},bl=Se(Ze,[["__scopeId","data-v-25cb7186"]]);export{bl as default};
