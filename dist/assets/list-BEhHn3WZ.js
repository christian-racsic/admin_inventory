import{_ as le}from"./DialogCloseBtn-CmFX9Z5g.js";import{r as n,o as X,c as T,a as D,w as l,b as e,d as i,t as _,e as te,f as R,u as a,g as w,V as I,x as O,i as p,s as se,h as H,k as Y,l as Z,F as ne,j as ue,C as ie}from"./index-CTHS9Uo5.js";import{$ as G}from"./api-DV6oDQ6t.js";import{V as J}from"./VCard-DCSOa-uS.js";import{V as W}from"./VCardText-DvHr5E0T.js";import{V as ae}from"./VForm-DutAvWyc.js";import{V as B,a as u}from"./VRow-BhAPnYDA.js";import{V as F}from"./VAlert-DEc64QkE.js";import{V as oe}from"./VDialog-BCy7d4kf.js";import{V as j}from"./VSelect-I2Djs2tK.js";import{V as re}from"./VAutocomplete-Deg3ZH1f.js";import{V as M}from"./VTextField-ZaB3RHnj.js";import{V as de}from"./VTextarea-7f9Dtzos.js";import{_ as ce}from"./IconBtn-DXVljAVB.js";import{_ as me}from"./AppDateTimePicker-BCLx0bW5.js";import{V as ee}from"./VTooltip-BiRPOg8i.js";import{V as pe}from"./VTable-2kho1lTo.js";import{V as ve}from"./VAvatar-B74PEF1E.js";import{V as fe}from"./VImg-DbUZi3rZ.js";import{V as _e}from"./VPagination-3n6UBKF_.js";import"./index-BYrzgnBV.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VOverlay-CQPilPWj.js";import"./VList-BeeB6M1u.js";import"./VDivider-D7LS911x.js";import"./VMenu-B-CF11VB.js";import"./VCheckboxBtn-Mk3d90yG.js";import"./VChip-C2kZ6mQo.js";import"./filter-DF6NMxOv.js";import"./_commonjsHelpers-Cpj98o6Y.js";const Ve={class:"text-center pb-6"},ge={class:"text-h4 mb-2"},be={__name:"ConversionDeleteDialog",props:{isDialogVisible:{type:Boolean,required:!0},conversionSelected:{type:Object,required:!0}},emits:["update:isDialogVisible","deleteConversion"],setup(K,{emit:E}){const V=K,y=E,g=n(null),r=n(null),c=n(null),C=async()=>{g.value=null,r.value=null,c.value=null;try{const v=await G("conversions/"+V.conversionSelected.id,{method:"DELETE",onResponseError({response:U}){r.value=U._data.error}});console.log(v),v.message==403?r.value=v.message_text:(y("deleteConversion",V.conversionSelected),b())}catch(v){console.log(v)}};X(()=>{console.log(V.conversionSelected)});const b=()=>{y("update:isDialogVisible",!1)},h=v=>{y("update:isDialogVisible",v)};return(v,U)=>{const x=le;return D(),T(oe,{"max-width":"650","model-value":V.isDialogVisible,"onUpdate:modelValue":h},{default:l(()=>[e(J,{class:"pa-sm-11 pa-3"},{default:l(()=>[e(x,{variant:"text",size:"default",onClick:b}),e(W,{class:"pt-5"},{default:l(()=>[i("div",Ve,[i("h4",ge," Delete Conversion : "+_(V.conversionSelected.id),1)]),e(ae,{class:"mt-4",onSubmit:te(C,["prevent"])},{default:l(()=>[e(B,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[i("p",null,"Â¿Estas seguro de eliminar esta conversiÃ³n : "+_(V.conversionSelected.product.title)+"?",1)]),_:1}),a(g)?(D(),T(u,{key:0,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"warning"},{default:l(()=>[w(_(a(g)),1)]),_:1})]),_:1})):R("",!0),a(r)?(D(),T(u,{key:1,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"error"},{default:l(()=>[w(_(a(r)),1)]),_:1})]),_:1})):R("",!0),a(c)?(D(),T(u,{key:2,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"success"},{default:l(()=>[w(_(a(c)),1)]),_:1})]),_:1})):R("",!0),e(u,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(I,{type:"submit",color:"error"},{default:l(()=>[w(" Eliminar ")]),_:1}),e(I,{color:"secondary",variant:"outlined",onClick:b},{default:l(()=>[w(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},ye=i("div",{class:"text-center pb-6"},[i("h4",{class:"text-h4 mb-2"}," Add ConversiÃ³n ")],-1),Ce={__name:"ConversionAddDialog",props:{isDialogVisible:{type:Boolean,required:!0},warehouses:{type:Object,required:!0},units:{type:Object,required:!0}},emits:["update:isDialogVisible","update:warehouses","addConversion"],setup(K,{emit:E}){const V=K,y=E,g=n(null),r=n(null),c=n(null),C=n(null),b=n(null),h=n(null),v=n([]),U=n([]),x=n([]),f=n(null),A=n(null),S=n(null),z=n(!1),$=n(),k=n(null),L=n([]),N=n(null);n(null),n(0),n(0);const Q=m=>{z.value=!0,setTimeout(async()=>{try{const o=await G("sales/search_product?search="+($.value?$.value:""),{method:"GET",onResponseError({response:q}){console.log(q._data.error)}});console.log(o),L.value=o.products.data,z.value=!1}catch(o){console.log(o)}},500)};O($,m=>{if(N.value=null,!g.value){setTimeout(()=>{N.value="En necesario seleccionar un almacÃ©n."},25);return}m.length>3?Q():L.value=[]}),O(k,m=>{console.log(m),m&&(U.value=m.warehouses.filter(o=>o.warehouse_id==g.value).map(o=>({id:o.unit_id,name:o.unit.name})))}),O(g,m=>{k.value&&(U.value=k.value.warehouses.filter(o=>o.warehouse_id==m).map(o=>({id:o.unit_id,name:o.unit.name})),r.value="",c.value="",x.value=[])}),O(r,m=>{console.log(m);let o=V.units.find(q=>q.id==m);o&&(x.value=o.conversions)});const d=async()=>{if(f.value=null,A.value=null,S.value=null,!g.value){setTimeout(()=>{f.value="Es necesario seleccionar un almacÃ©n"},50);return}if(!k.value){setTimeout(()=>{f.value="Es necesario seleccionar un producto"},50);return}if(!r.value){setTimeout(()=>{f.value="Es necesario seleccionar una unidad de inicio"},50);return}if(!c.value){setTimeout(()=>{f.value="Es necesario seleccionar una unidad a convertir"},50);return}if(!C.value||C.value<=0){setTimeout(()=>{f.value="Se necesita digitar una cantidad de inicio mayor a 0"},50);return}if(!b.value){setTimeout(()=>{f.value="Se necesita digitar una cantidad a convertir mayor a 0"},50);return}if(!h.value){setTimeout(()=>{f.value="Se debe llenar la descripciÃ³n"},50);return}let m={warehouse_id:g.value,product_id:k.value.id,unit_start_id:r.value,unit_end_id:c.value,quantity_start:C.value,quantity_end:b.value,description:h.value};try{const o=await G("conversions",{method:"POST",body:m,onResponseError({response:q}){A.value=q._data.error}});console.log(o),o.message==403?A.value=o.message_text:(S.value="La conversiÃ³n se ha registrado correctamente",y("addConversion",o.conversion),g.value="",k.value=null,$.value="",U.value=[],r.value="",c.value="",C.value=0,b.value=0,h.value="",f.value=null,A.value=null,S.value=null,s())}catch(o){console.log(o)}},s=()=>{y("update:isDialogVisible",!1)},P=m=>{y("update:isDialogVisible",m)};return X(()=>{v.value=V.warehouses,console.log(V.warehouses)}),(m,o)=>{const q=le;return D(),T(oe,{"max-width":"650","model-value":V.isDialogVisible,"onUpdate:modelValue":P},{default:l(()=>[e(J,{class:"pa-sm-11 pa-3"},{default:l(()=>[e(q,{variant:"text",size:"default",onClick:s}),e(W,{class:"pt-5"},{default:l(()=>[ye,e(ae,{class:"mt-4",onSubmit:te(d,["prevent"])},{default:l(()=>[e(B,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(j,{items:a(v),"item-title":"name","item-value":"id",placeholder:"Select",modelValue:a(g),"onUpdate:modelValue":o[0]||(o[0]=t=>p(g)?g.value=t:null),label:"Almacenes"},null,8,["items","modelValue"])]),_:1}),e(u,{cols:"12"},{default:l(()=>[e(B,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(B,null,{default:l(()=>[e(u,{cols:"12"},{default:l(()=>[e(re,{modelValue:a(k),"onUpdate:modelValue":o[1]||(o[1]=t=>p(k)?k.value=t:null),search:a($),"onUpdate:search":o[2]||(o[2]=t=>p($)?$.value=t:null),loading:a(z),items:a(L),"item-title":"title","item-value":"id","return-object":"",placeholder:"Search for a product",label:"Â¿Que agregamos?",variant:"underlined","menu-props":{maxHeight:"200px"}},null,8,["modelValue","search","loading","items"])]),_:1}),a(N)?(D(),T(u,{key:0,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"warning"},{default:l(()=>[w(_(a(N)),1)]),_:1})]),_:1})):R("",!0)]),_:1})]),_:1}),e(u,{cols:"12"},{default:l(()=>[e(B,null,{default:l(()=>[e(u,{cols:"10"},{default:l(()=>[e(B,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(j,{items:a(U),"item-title":"name","item-value":"id",placeholder:"Select",modelValue:a(r),"onUpdate:modelValue":o[3]||(o[3]=t=>p(r)?r.value=t:null),label:"Unidad de inicio"},null,8,["items","modelValue"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(M,{label:"Cantidad",type:"number",modelValue:a(C),"onUpdate:modelValue":o[4]||(o[4]=t=>p(C)?C.value=t:null),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(u,{cols:"10"},{default:l(()=>[e(B,null,{default:l(()=>[e(u,{cols:"6"},{default:l(()=>[e(j,{items:a(x),"item-title":"name","item-value":"id",placeholder:"Select",modelValue:a(c),"onUpdate:modelValue":o[5]||(o[5]=t=>p(c)?c.value=t:null),label:"Unidad a convertir"},null,8,["items","modelValue"])]),_:1}),e(u,{cols:"6"},{default:l(()=>[e(M,{label:"Cantidad",type:"number",modelValue:a(b),"onUpdate:modelValue":o[6]||(o[6]=t=>p(b)?b.value=t:null),placeholder:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{cols:"12"},{default:l(()=>[e(de,{modelValue:a(h),"onUpdate:modelValue":o[7]||(o[7]=t=>p(h)?h.value=t:null),label:"DescripciÃ³n: ",placeholder:""},null,8,["modelValue"])]),_:1}),a(f)?(D(),T(u,{key:0,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"warning"},{default:l(()=>[w(_(a(f)),1)]),_:1})]),_:1})):R("",!0),a(A)?(D(),T(u,{key:1,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"error"},{default:l(()=>[w(_(a(A)),1)]),_:1})]),_:1})):R("",!0),a(S)?(D(),T(u,{key:2,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"success"},{default:l(()=>[w(_(a(S)),1)]),_:1})]),_:1})):R("",!0),e(u,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(I,{type:"submit"},{default:l(()=>[w(" Guardar ")]),_:1}),e(I,{color:"secondary",variant:"outlined",onClick:s},{default:l(()=>[w(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},he=i("thead",null,[i("tr",null,[i("th",{class:"text-uppercase"}," NÂ° ConversiÃ³n "),i("th",{class:"text-uppercase"}," Producto "),i("th",{class:"text-uppercase"}," AlmacÃ©n "),i("th",{class:"text-uppercase"}," Unidad Inicial "),i("th",{class:"text-uppercase"}," Cantidad inicial "),i("th",{class:"text-uppercase"}," Unidad Final "),i("th",{class:"text-uppercase"}," Cantidad final "),i("th",{class:"text-uppercase"}," Fecha de registro "),i("th",{class:"text-uppercase"}," Acciones ")])],-1),xe={class:"d-flex align-center"},we={class:"d-flex ms-3"},De={class:"d-flex gap-1"},ol={__name:"list",setup(K){se();const E=n(!1),V=n(!1),y=n(1),g=n(0),r=n([]),c=n([]),C=n([]),b=n(null),h=n(null),v=n(null),U=n(null),x=n(null),f=n(null),A=n(null),S=async()=>{try{let d={search_product:b.value,warehouse_id:h.value,unit_start_id:v.value,unit_end_id:U.value,start_date:x.value?x.value.split("to")[0]:null,end_date:x.value?x.value.split("to")[1]:null,conversion_id:f.value};const s=await G("conversions/index?page="+y.value,{method:"POST",body:d,onResponseError({response:P}){console.log(P._data.error)}});console.log(s),r.value=s.conversions.data,g.value=s.total_page}catch(d){console.log(d)}};O(y,d=>{console.log(d),S()});const z=()=>{b.value="",h.value=null,v.value=null,U.value=null,y.value=1,x.value=null,f.value=null,S()},$=async()=>{try{const d=await G("products/config",{method:"GET",onResponseError({response:s}){console.log(s._data.error)}});console.log(d),c.value=d.warehouses,C.value=d.units}catch(d){console.log(d)}},k=()=>{V.value=!0},L=d=>{r.value.unshift(d)},N=d=>{let s=r.value.findIndex(P=>P.id==d.id);s!=-1&&r.value.splice(s,1)},Q=d=>{E.value=!0,A.value=d};return X(()=>{S(),$()}),(d,s)=>{const P=me,m=ce,o=Ce,q=be;return D(),H("div",null,[e(J,{title:"ðŸ—‚ï¸ ConversiÃ³n de unidades"},{default:l(()=>[e(W,null,{default:l(()=>[e(B,{class:""},{default:l(()=>[e(u,{cols:"10"},{default:l(()=>[e(B,null,{default:l(()=>[e(u,{cols:"3"},{default:l(()=>[e(M,{placeholder:"Buscar NÂ° Registro",density:"compact",class:"me-3",modelValue:a(f),"onUpdate:modelValue":s[0]||(s[0]=t=>p(f)?f.value=t:null),onKeyup:Y(S,["enter"])},null,8,["modelValue"])]),_:1}),e(u,{cols:"3"},{default:l(()=>[e(M,{placeholder:"Buscar Producto",density:"compact",class:"me-3",modelValue:a(b),"onUpdate:modelValue":s[1]||(s[1]=t=>p(b)?b.value=t:null),onKeyup:Y(S,["enter"])},null,8,["modelValue"])]),_:1}),e(u,{cols:"2"},{default:l(()=>[e(j,{items:a(c),"item-title":"name","item-value":"id",placeholder:"Select",modelValue:a(h),"onUpdate:modelValue":s[2]||(s[2]=t=>p(h)?h.value=t:null),label:"Almacenes"},null,8,["items","modelValue"])]),_:1}),e(u,{cols:"2"},{default:l(()=>[e(j,{items:a(C),"item-title":"name","item-value":"id",placeholder:"Select",modelValue:a(v),"onUpdate:modelValue":s[3]||(s[3]=t=>p(v)?v.value=t:null),label:"Unidad inicial"},null,8,["items","modelValue"])]),_:1}),e(u,{cols:"2"},{default:l(()=>[e(j,{items:a(C),"item-title":"name","item-value":"id",placeholder:"Select",modelValue:a(U),"onUpdate:modelValue":s[4]||(s[4]=t=>p(U)?U.value=t:null),label:"Unidad final"},null,8,["items","modelValue"])]),_:1}),e(u,{cols:"3"},{default:l(()=>[e(P,{modelValue:a(x),"onUpdate:modelValue":s[5]||(s[5]=t=>p(x)?x.value=t:null),label:"Rango de fecha",placeholder:"Select date",config:{mode:"range"}},null,8,["modelValue"])]),_:1}),e(u,{cols:"3"},{default:l(()=>[e(I,{color:"info",class:"mx-1","prepend-icon":"ri-search-2-line",onClick:s[6]||(s[6]=t=>S())},{default:l(()=>[e(ee,{activator:"parent",location:"top"},{default:l(()=>[w(" Buscar ")]),_:1})]),_:1}),e(I,{color:"secondary",class:"mx-1","prepend-icon":"ri-restart-line",onClick:s[7]||(s[7]=t=>z())},{default:l(()=>[e(ee,{activator:"parent",location:"top"},{default:l(()=>[w(" Limpieza ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(u,{cols:"2",class:"text-end"},{default:l(()=>[e(I,{onClick:s[8]||(s[8]=t=>k())},{default:l(()=>[w(" AÃ±adir conversiÃ³n "),e(Z,{end:"",icon:"ri-add-line"})]),_:1})]),_:1})]),_:1})]),_:1}),e(pe,null,{default:l(()=>[he,i("tbody",null,[(D(!0),H(ne,null,ue(a(r),t=>(D(),H("tr",{key:t.id},[i("td",null,_(t.id),1),i("td",null,[i("div",xe,[e(ve,{size:"32",color:t.product.imagen?"":"primary",class:ie(t.product.imagen?"":"v-avatar-light-bg primary--text"),variant:t.product.imagen?void 0:"tonal"},{default:l(()=>[e(fe,{src:t.product.imagen},null,8,["src"])]),_:2},1032,["color","class","variant"]),i("div",we,_(t.product.title),1)])]),i("td",null,_(t.warehouse.name),1),i("td",null,_(t.unit_start.name),1),i("td",null,_(t.quantity_start),1),i("td",null,_(t.unit_end.name),1),i("td",null,_(t.quantity_end),1),i("td",null,_(t.created_at),1),i("td",null,[i("div",De,[e(m,{size:"small",onClick:Ue=>Q(t)},{default:l(()=>[e(Z,{icon:"ri-delete-bin-line"})]),_:2},1032,["onClick"])])])]))),128))])]),_:1}),e(_e,{modelValue:a(y),"onUpdate:modelValue":s[9]||(s[9]=t=>p(y)?y.value=t:null),length:a(g)},null,8,["modelValue","length"])]),_:1}),a(c).length>0?(D(),T(o,{key:0,isDialogVisible:a(V),"onUpdate:isDialogVisible":s[10]||(s[10]=t=>p(V)?V.value=t:null),onAddConversion:L,warehouses:a(c),"onUpdate:warehouses":s[11]||(s[11]=t=>p(c)?c.value=t:null),units:a(C)},null,8,["isDialogVisible","warehouses","units"])):R("",!0),a(A)&&a(E)?(D(),T(q,{key:1,isDialogVisible:a(E),"onUpdate:isDialogVisible":s[12]||(s[12]=t=>p(E)?E.value=t:null),conversionSelected:a(A),onDeleteConversion:N},null,8,["isDialogVisible","conversionSelected"])):R("",!0)])}}};export{ol as default};
