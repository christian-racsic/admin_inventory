import{i as N}from"./constants-BXcKDdXi.js";import{r,o as Q,c,a as i,w as l,b as e,d as s,t as p,e as ae,f,u as v,g as m,V as E,s as se,a6 as re,x as ne,h as O,k as q,l as U,F as ie,j as ue}from"./index-W4kja-31.js";import{_ as de}from"./DialogCloseBtn-Cpwqmvb9.js";import{$ as L}from"./api-DxrbhZSf.js";import{V as J}from"./VCard-CrSgQsdG.js";import{V as W}from"./VCardText-D-w9kZpv.js";import{V as ce}from"./VForm-D3Vuhlg_.js";import{V as j,a as n}from"./VRow-f7OHVuKd.js";import{V as F}from"./VAlert-ELbKA5bW.js";import{V as pe}from"./VDialog-CqxdfU_E.js";import{_ as me}from"./IconBtn-BnO4JjSS.js";import{_ as fe}from"./AppDateTimePicker-BFxRjtXb.js";import{V as G}from"./VTextField-DIHLaahk.js";import{V as B}from"./VSelect-CLTqdzaG.js";import{V as H}from"./VTooltip-DOtX7Pla.js";import{V as ve}from"./VTable-Cddsam7K.js";import{V as z}from"./VChip-6YKG-Q6j.js";import{V as _e}from"./VPagination-D84KJ4BT.js";import"./index-BYrzgnBV.js";import"./VAvatar-D-KF6a6N.js";import"./VImg-BXz4PYAy.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VOverlay-DsWRzxlS.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./VList-DFWg69W8.js";import"./VDivider-D7rU52Ox.js";import"./VMenu-HxKMt7sI.js";import"./VCheckboxBtn-D15mcKdF.js";const Ve={class:"text-center pb-6"},ge={class:"text-h4 mb-2"},he={__name:"PurchaseDeleteDialog",props:{isDialogVisible:{type:Boolean,required:!0},purchaseSelected:{type:Object,required:!0}},emits:["update:isDialogVisible","deletePurchase"],setup(K,{emit:S}){const u=K,_=S,b=r(null),V=r(null),y=r(null),T=async()=>{b.value=null,V.value=null,y.value=null;try{const d=await L("purchase/"+u.purchaseSelected.id,{method:"DELETE",onResponseError({response:g}){V.value=g._data.error}});console.log(d),_("deletePurchase",u.purchaseSelected),C()}catch(d){console.log(d)}};Q(()=>{console.log(u.purchaseSelected)});const C=()=>{_("update:isDialogVisible",!1)},k=d=>{_("update:isDialogVisible",d)};return(d,g)=>{const P=de;return i(),c(pe,{"max-width":"650","model-value":u.isDialogVisible,"onUpdate:modelValue":k},{default:l(()=>[e(J,{class:"pa-sm-11 pa-3"},{default:l(()=>[e(P,{variant:"text",size:"default",onClick:C}),e(W,{class:"pt-5"},{default:l(()=>[s("div",Ve,[s("h4",ge," Delete Purchase : "+p(u.purchaseSelected.id),1)]),e(ce,{class:"mt-4",onSubmit:ae(T,["prevent"])},{default:l(()=>[e(j,null,{default:l(()=>[e(n,{cols:"12"},{default:l(()=>[s("p",null,"Â¿Estas seguro de eliminar esta compra : #"+p(u.purchaseSelected.id)+"?",1)]),_:1}),v(b)?(i(),c(n,{key:0,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"warning"},{default:l(()=>[m(p(v(b)),1)]),_:1})]),_:1})):f("",!0),v(V)?(i(),c(n,{key:1,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"error"},{default:l(()=>[m(p(v(V)),1)]),_:1})]),_:1})):f("",!0),v(y)?(i(),c(n,{key:2,cols:"12"},{default:l(()=>[e(F,{closable:"","close-label":"Close Alert",color:"success"},{default:l(()=>[m(p(v(y)),1)]),_:1})]),_:1})):f("",!0),e(n,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:l(()=>[e(E,{type:"submit",color:"error"},{default:l(()=>[m(" Eliminar ")]),_:1}),e(E,{color:"secondary",variant:"outlined",onClick:C},{default:l(()=>[m(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},be=s("thead",null,[s("tr",null,[s("th",{class:"text-uppercase"},"NÂ° Compra"),s("th",{class:"text-uppercase"},"Almacen"),s("th",{class:"text-uppercase"},"Proveedor"),s("th",{class:"text-uppercase"},"Fecha de emisiÃ³n"),s("th",{class:"text-uppercase"},"Tipo de Comprobante"),s("th",{class:"text-uppercase"},"NÂ° de Comprobante"),s("th",{class:"text-uppercase"},"Estado de E."),s("th",{class:"text-uppercase"},"Acciones")])],-1),ye={class:"d-flex gap-1"},Xe={__name:"list",setup(K){const S=se(),u=r(!1),_=r(1),b=r(0),V=r([]),y=r([]),T=r([]),C=r([]),k=r(null),d=r(null),g=r(null),P=r(null),$=r(null),A=r(null),R=r(null),I=r(null),X=re(()=>"http://api.ciscarerp.duckdns.org/api".replace(/\/?$/,"/")),D=async()=>{try{const[a,o]=(A.value||"").split("to").map(x=>x?x.trim():null),w={search:k.value,warehouse_id:d.value,unit_id:g.value,provider_id:P.value,type_comprobant:$.value,start_date:a||null,end_date:o||null,search_product:R.value},h=await L("purchase/index?page="+_.value,{method:"POST",body:w,onResponseError({response:x}){console.log(x._data.error)}});console.log(h),V.value=h.purchases.data,b.value=h.total_page}catch(a){console.log(a)}};ne(_,a=>{console.log(a),D()});const Y=()=>{k.value=null,d.value=null,g.value=null,_.value=1,P.value=null,A.value=null,$.value=null,R.value=null,D()},Z=async()=>{try{const a=await L("purchase/config",{method:"GET",onResponseError({response:o}){console.log(o._data.error)}});console.log(a),y.value=a.warehouses,T.value=a.units,C.value=a.providers}catch(a){console.log(a)}},ee=a=>{const o=V.value.findIndex(w=>w.id==a.id);o!==-1&&V.value.splice(o,1)},le=a=>{S.push({name:"purchase-edit-id",params:{id:a.id}})},te=a=>{u.value=!0,I.value=a},oe=a=>{const o=`${X.value}purchase-pdf/${encodeURIComponent(a.id)}`;window.open(o,"_blank")};return Q(()=>{D(),Z()}),(a,o)=>{const w=fe,h=me,x=he;return i(),O("div",null,[e(J,{title:"ðŸ—ƒï¸ Compras"},{default:l(()=>[e(W,null,{default:l(()=>[e(j,null,{default:l(()=>[e(n,{cols:"10"},{default:l(()=>[e(j,null,{default:l(()=>[e(n,{cols:"3"},{default:l(()=>[e(G,{placeholder:"Buscar NÂ° Compra",density:"compact",class:"me-3",modelValue:k.value,"onUpdate:modelValue":o[0]||(o[0]=t=>k.value=t),onKeyup:q(D,["enter"])},null,8,["modelValue"])]),_:1}),e(n,{cols:"3"},{default:l(()=>[e(B,{items:y.value,"item-title":"name","item-value":"id",placeholder:"Select",modelValue:d.value,"onUpdate:modelValue":o[1]||(o[1]=t=>d.value=t),label:"Almacenes"},null,8,["items","modelValue"])]),_:1}),e(n,{cols:"3"},{default:l(()=>[e(B,{items:T.value,"item-title":"name","item-value":"id",placeholder:"Select",modelValue:g.value,"onUpdate:modelValue":o[2]||(o[2]=t=>g.value=t),label:"Unidades"},null,8,["items","modelValue"])]),_:1}),e(n,{cols:"3"},{default:l(()=>[e(B,{placeholder:"Select",label:"Proveedor",items:C.value,"item-title":"full_name","item-value":"id",modelValue:P.value,"onUpdate:modelValue":o[3]||(o[3]=t=>P.value=t)},null,8,["items","modelValue"])]),_:1}),e(n,{cols:"3"},{default:l(()=>[e(B,{items:["FACTURA ELECTRÃ“NICA","NOTA DE CREDITO","NOTA DE DEBITO","RECIBO POR HONARIOS","GUIA DE REMISIÃ“N"],modelValue:$.value,"onUpdate:modelValue":o[4]||(o[4]=t=>$.value=t),label:"Tipo de Comprobantes",placeholder:"Select Tipo",eager:""},null,8,["modelValue"])]),_:1}),e(n,{cols:"3"},{default:l(()=>[e(w,{modelValue:A.value,"onUpdate:modelValue":o[5]||(o[5]=t=>A.value=t),label:"Rango de fecha",placeholder:"Seleccionar Fecha",config:{mode:"range"}},null,8,["modelValue"])]),_:1}),e(n,{cols:"3"},{default:l(()=>[e(G,{placeholder:"Buscar Producto",density:"compact",class:"me-3",modelValue:R.value,"onUpdate:modelValue":o[6]||(o[6]=t=>R.value=t),onKeyup:q(D,["enter"])},null,8,["modelValue"])]),_:1}),e(n,{cols:"2"},{default:l(()=>[e(E,{color:"info",class:"mx-1","prepend-icon":"ri-search-2-line",onClick:o[7]||(o[7]=t=>D())},{default:l(()=>[e(H,{activator:"parent",location:"top"},{default:l(()=>[m(" Buscar ")]),_:1})]),_:1}),e(E,{color:"secondary",class:"mx-1","prepend-icon":"ri-restart-line",onClick:o[8]||(o[8]=t=>Y())},{default:l(()=>[e(H,{activator:"parent",location:"top"},{default:l(()=>[m(" Limpieza ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(n,{cols:"2",class:"text-end"},{default:l(()=>[("isPermission"in a?a.isPermission:v(N))("register_purchase")?(i(),c(E,{key:0,onClick:o[9]||(o[9]=t=>v(S).push({name:"purchase-add"}))},{default:l(()=>[m(" Add Purchase "),e(U,{end:"",icon:"ri-add-line"})]),_:1})):f("",!0)]),_:1})]),_:1})]),_:1}),e(ve,null,{default:l(()=>[be,s("tbody",null,[(i(!0),O(ie,null,ue(V.value,t=>(i(),O("tr",{key:t.id},[s("td",null,p(t.id),1),s("td",null,p(t.warehouse.name),1),s("td",null,p(t.provider.full_name),1),s("td",null,p(t.date_emision),1),s("td",null,p(t.type_comprobant),1),s("td",null,p(t.n_comprobant),1),s("td",null,[t.state==1?(i(),c(z,{key:0,color:"error"},{default:l(()=>[m("Solicitud")]),_:1})):f("",!0),t.state==2?(i(),c(z,{key:1,color:"warning"},{default:l(()=>[m("Parcial")]),_:1})):f("",!0),t.state==3?(i(),c(z,{key:2,color:"primary"},{default:l(()=>[m("Completo")]),_:1})):f("",!0)]),s("td",null,[s("div",ye,[e(h,{size:"small",onClick:M=>oe(t)},{default:l(()=>[e(U,{icon:"ri-file-pdf-2-line"})]),_:2},1032,["onClick"]),("isPermission"in a?a.isPermission:v(N))("edit_purchase")?(i(),c(h,{key:0,size:"small",onClick:M=>le(t)},{default:l(()=>[e(U,{icon:"ri-pencil-line"})]),_:2},1032,["onClick"])):f("",!0),t.state==1&&("isPermission"in a?a.isPermission:v(N))("delete_purchase")?(i(),c(h,{key:1,size:"small",onClick:M=>te(t)},{default:l(()=>[e(U,{icon:"ri-delete-bin-line"})]),_:2},1032,["onClick"])):f("",!0)])])]))),128))])]),_:1}),e(_e,{modelValue:_.value,"onUpdate:modelValue":o[10]||(o[10]=t=>_.value=t),length:b.value},null,8,["modelValue","length"])]),_:1}),I.value&&u.value?(i(),c(x,{key:0,isDialogVisible:u.value,"onUpdate:isDialogVisible":o[11]||(o[11]=t=>u.value=t),purchaseSelected:I.value,onDeletePurchase:ee},null,8,["isDialogVisible","purchaseSelected"])):f("",!0)])}}};export{Xe as default};
