import{P as M,i as L}from"./constants-BXcKDdXi.js";import{r as p,o as K,c as g,a as n,w as e,b as l,d as r,t as V,e as Q,f as k,u as t,g as y,V as $,i as I,h as S,F as N,j as O,k as oe,l as G}from"./index-W4kja-31.js";import{_ as H}from"./DialogCloseBtn-Cpwqmvb9.js";import{$ as F}from"./api-DxrbhZSf.js";import{V as j}from"./VCard-CrSgQsdG.js";import{V as q}from"./VCardText-D-w9kZpv.js";import{V as J}from"./VForm-D3Vuhlg_.js";import{V as z,a as _}from"./VRow-f7OHVuKd.js";import{V as E}from"./VAlert-ELbKA5bW.js";import{V as W}from"./VDialog-CqxdfU_E.js";import{V as Y}from"./VTextField-DIHLaahk.js";import{V as Z}from"./VTable-Cddsam7K.js";import{V as ee}from"./VCheckbox-D0DXs1MP.js";import{_ as te}from"./IconBtn-BnO4JjSS.js";import{V as se}from"./VDataTable-Ctd8mvtt.js";import"./index-BYrzgnBV.js";import"./VAvatar-D-KF6a6N.js";import"./VImg-BXz4PYAy.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VOverlay-DsWRzxlS.js";import"./VCheckboxBtn-D15mcKdF.js";import"./VPagination-D84KJ4BT.js";import"./VSelect-CLTqdzaG.js";import"./VList-DFWg69W8.js";import"./VDivider-D7rU52Ox.js";import"./VMenu-HxKMt7sI.js";import"./VChip-6YKG-Q6j.js";import"./filter-CbKp_48J.js";const ae={class:"text-center pb-6"},ie={class:"text-h4 mb-2"},ne={__name:"RoleDeleteDialog",props:{isDialogVisible:{type:Boolean,required:!0},roleSelected:{type:Object,required:!0}},emits:["update:isDialogVisible","deleteRole"],setup(T,{emit:A}){const c=T,b=A,u=p(null),s=p(null),d=p(null),f=async()=>{u.value=null,s.value=null,d.value=null;try{const R=await F("role/"+c.roleSelected.id,{method:"DELETE",onResponseError({response:C}){s.value=C._data.error}});console.log(R),b("deleteRole",c.roleSelected),v()}catch(R){console.log(R)}};K(()=>{console.log(c.roleSelected)});const v=()=>{b("update:isDialogVisible",!1)},w=R=>{b("update:isDialogVisible",R)};return(R,C)=>{const P=H;return n(),g(W,{"max-width":"650","model-value":c.isDialogVisible,"onUpdate:modelValue":w},{default:e(()=>[l(j,{class:"pa-sm-11 pa-3"},{default:e(()=>[l(P,{variant:"text",size:"default",onClick:v}),l(q,{class:"pt-5"},{default:e(()=>[r("div",ae,[r("h4",ie," Delete Role : "+V(c.roleSelected.id),1)]),l(J,{class:"mt-4",onSubmit:Q(f,["prevent"])},{default:e(()=>[l(z,null,{default:e(()=>[l(_,{cols:"12"},{default:e(()=>[r("p",null,"Â¿Estas seguro de eliminar el ROL : "+V(c.roleSelected.name)+"?",1)]),_:1}),t(u)?(n(),g(_,{key:0,cols:"12"},{default:e(()=>[l(E,{closable:"","close-label":"Close Alert",color:"warning"},{default:e(()=>[y(V(t(u)),1)]),_:1})]),_:1})):k("",!0),t(s)?(n(),g(_,{key:1,cols:"12"},{default:e(()=>[l(E,{closable:"","close-label":"Close Alert",color:"error"},{default:e(()=>[y(V(t(s)),1)]),_:1})]),_:1})):k("",!0),t(d)?(n(),g(_,{key:2,cols:"12"},{default:e(()=>[l(E,{closable:"","close-label":"Close Alert",color:"success"},{default:e(()=>[y(V(t(d)),1)]),_:1})]),_:1})):k("",!0),l(_,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:e(()=>[l($,{type:"submit",color:"error"},{default:e(()=>[y(" Eliminar ")]),_:1}),l($,{color:"secondary",variant:"outlined",onClick:v},{default:e(()=>[y(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},re={class:"text-center pb-6"},ue={class:"text-h4 mb-2"},de=r("thead",null,[r("tr",null,[r("th",{class:"text-uppercase"}," Modulo "),r("th",{class:"text-uppercase"}," Permisos ")])],-1),ce={__name:"RoleEditDialog",props:{isDialogVisible:{type:Boolean,required:!0},roleSelected:{type:Object,required:!0}},emits:["update:isDialogVisible","editRole"],setup(T,{emit:A}){const c=T,b=A,u=p(null);console.log(M);const s=p([]),d=p(null),f=p(null),v=p(null),w=m=>{let i=s.value.findIndex(o=>o==m);i!=-1?s.value.splice(i,1):s.value.push(m),console.log(s)},R=async()=>{if(d.value=null,f.value=null,v.value=null,!u.value){setTimeout(()=>{d.value="Se debe llenar el nombre del rol"},50);return}if(s.value.length==0){setTimeout(()=>{d.value="Se debe seleccionar almenos un permiso"},50);return}let m={name:u.value,permissions:s.value};try{const i=await F("role/"+c.roleSelected.id,{method:"PUT",body:m,onResponseError({response:o}){f.value=o._data.error}});console.log(i),i.message==403?f.value=i.message_text:(v.value="El rol se ha EDITADO correctamente",b("editRole",i.role),d.value=null,f.value=null)}catch(i){console.log(i)}};K(()=>{console.log(c.roleSelected),u.value=c.roleSelected.name,s.value=c.roleSelected.permissions_pluck});const C=()=>{b("update:isDialogVisible",!1)},P=m=>{b("update:isDialogVisible",m)};return(m,i)=>{const o=H;return n(),g(W,{"max-width":"650","model-value":c.isDialogVisible,"onUpdate:modelValue":P},{default:e(()=>[l(j,{class:"pa-sm-11 pa-3"},{default:e(()=>[l(o,{variant:"text",size:"default",onClick:C}),l(q,{class:"pt-5"},{default:e(()=>[r("div",re,[r("h4",ue," Edit Role : "+V(c.roleSelected.id),1)]),l(J,{class:"mt-4",onSubmit:Q(R,["prevent"])},{default:e(()=>[l(z,null,{default:e(()=>[l(_,{cols:"12"},{default:e(()=>[l(Y,{modelValue:t(u),"onUpdate:modelValue":i[0]||(i[0]=a=>I(u)?u.value=a:null),label:"Nombre",placeholder:"Example: Admin"},null,8,["modelValue"])]),_:1}),t(d)?(n(),g(_,{key:0,cols:"12"},{default:e(()=>[l(E,{closable:"","close-label":"Close Alert",color:"warning"},{default:e(()=>[y(V(t(d)),1)]),_:1})]),_:1})):k("",!0),t(f)?(n(),g(_,{key:1,cols:"12"},{default:e(()=>[l(E,{closable:"","close-label":"Close Alert",color:"error"},{default:e(()=>[y(V(t(f)),1)]),_:1})]),_:1})):k("",!0),t(v)?(n(),g(_,{key:2,cols:"12"},{default:e(()=>[l(E,{closable:"","close-label":"Close Alert",color:"success"},{default:e(()=>[y(V(t(v)),1)]),_:1})]),_:1})):k("",!0),l(_,{cols:"12"},{default:e(()=>[l(Z,null,{default:e(()=>[de,r("tbody",null,[(n(!0),S(N,null,O("PERMISOS"in m?m.PERMISOS:t(M),(a,x)=>(n(),S("tr",{key:x},[r("td",null,V(a.name),1),r("td",null,[r("ul",null,[(n(!0),S(N,null,O(a.permisos,(h,U)=>(n(),S("li",{key:U,style:{"list-style":"none"}},[l(ee,{modelValue:t(s),"onUpdate:modelValue":i[1]||(i[1]=B=>I(s)?s.value=B:null),label:h.name,value:h.permiso,onClick:B=>w(h.permiso)},null,8,["modelValue","label","value","onClick"])]))),128))])])]))),128))])]),_:1})]),_:1}),l(_,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:e(()=>[l($,{type:"submit"},{default:e(()=>[y(" Editar ")]),_:1}),l($,{color:"secondary",variant:"outlined",onClick:C},{default:e(()=>[y(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},me=r("div",{class:"text-center pb-6"},[r("h4",{class:"text-h4 mb-2"}," Add Role ")],-1),pe=r("thead",null,[r("tr",null,[r("th",{class:"text-uppercase"}," Modulo "),r("th",{class:"text-uppercase"}," Permisos ")])],-1),fe={__name:"RoleAddDialog",props:{isDialogVisible:{type:Boolean,required:!0}},emits:["update:isDialogVisible","addRole"],setup(T,{emit:A}){const c=T,b=A,u=p(null);console.log(M);const s=p([]),d=p(null),f=p(null),v=p(null),w=m=>{let i=s.value.findIndex(o=>o==m);i!=-1?s.value.splice(i,1):s.value.push(m),console.log(s)},R=async()=>{if(d.value=null,f.value=null,v.value=null,!u.value){setTimeout(()=>{d.value="Se debe llenar el nombre del rol"},50);return}if(s.value.length==0){setTimeout(()=>{d.value="Se debe seleccionar almenos un permiso"},50);return}let m={name:u.value,permissions:s.value};try{const i=await F("role",{method:"POST",body:m,onResponseError({response:o}){f.value=o._data.error}});console.log(i),i.message==403?f.value=i.message_text:(v.value="El rol se ha registrado correctamente",b("addRole",i.role),u.value="",s.value=[],d.value=null,f.value=null,v.value=null,C())}catch(i){console.log(i)}},C=()=>{b("update:isDialogVisible",!1)},P=m=>{b("update:isDialogVisible",m)};return(m,i)=>{const o=H;return n(),g(W,{"max-width":"650","model-value":c.isDialogVisible,"onUpdate:modelValue":P},{default:e(()=>[l(j,{class:"pa-sm-11 pa-3"},{default:e(()=>[l(o,{variant:"text",size:"default",onClick:C}),l(q,{class:"pt-5"},{default:e(()=>[me,l(J,{class:"mt-4",onSubmit:Q(R,["prevent"])},{default:e(()=>[l(z,null,{default:e(()=>[l(_,{cols:"12"},{default:e(()=>[l(Y,{modelValue:t(u),"onUpdate:modelValue":i[0]||(i[0]=a=>I(u)?u.value=a:null),label:"Nombre",placeholder:"Example: Admin"},null,8,["modelValue"])]),_:1}),t(d)?(n(),g(_,{key:0,cols:"12"},{default:e(()=>[l(E,{closable:"","close-label":"Close Alert",color:"warning"},{default:e(()=>[y(V(t(d)),1)]),_:1})]),_:1})):k("",!0),t(f)?(n(),g(_,{key:1,cols:"12"},{default:e(()=>[l(E,{closable:"","close-label":"Close Alert",color:"error"},{default:e(()=>[y(V(t(f)),1)]),_:1})]),_:1})):k("",!0),t(v)?(n(),g(_,{key:2,cols:"12"},{default:e(()=>[l(E,{closable:"","close-label":"Close Alert",color:"success"},{default:e(()=>[y(V(t(v)),1)]),_:1})]),_:1})):k("",!0),l(_,{cols:"12"},{default:e(()=>[l(Z,null,{default:e(()=>[pe,r("tbody",null,[(n(!0),S(N,null,O("PERMISOS"in m?m.PERMISOS:t(M),(a,x)=>(n(),S("tr",{key:x},[r("td",null,V(a.name),1),r("td",null,[r("ul",null,[(n(!0),S(N,null,O(a.permisos,(h,U)=>(n(),S("li",{key:U,style:{"list-style":"none"}},[l(ee,{label:h.name,value:h.permiso,onClick:B=>w(h.permiso)},null,8,["label","value","onClick"])]))),128))])])]))),128))])]),_:1})]),_:1}),l(_,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:e(()=>[l($,{type:"submit"},{default:e(()=>[y(" Guardar ")]),_:1}),l($,{color:"secondary",variant:"outlined",onClick:C},{default:e(()=>[y(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])}}},_e={class:"text-h6"},ve={class:"d-flex gap-1"},Ge={__name:"index",setup(T){p([]);const A=[{title:"ID",key:"id"},{title:"Rol",key:"name"},{title:"Fecha de registro",key:"created_at"},{title:"Permisos",key:"permissions_pluck"},{title:"Acciones",key:"action"}],c=p(!1),b=p(!1),u=p(!1),s=p([]),d=p(null),f=p(null),v=p(null),w=async()=>{try{const o=await F("role?search="+(d.value?d.value:""),{method:"GET",onResponseError({response:a}){console.log(a._data.error)}});console.log(o),s.value=o.roles}catch(o){console.log(o)}},R=o=>{console.log(o);let a=s.value;s.value=[],a.unshift(o),setTimeout(()=>{s.value=a},50)},C=o=>{console.log(o);let a=s.value;s.value=[];let x=a.findIndex(h=>h.id==o.id);x!=-1&&(a[x]=o),setTimeout(()=>{s.value=a},50)},P=o=>{console.log(o);let a=s.value;s.value=[];let x=a.findIndex(h=>h.id==o.id);x!=-1&&a.splice(x,1),setTimeout(()=>{s.value=a},50)},m=o=>{console.log(o),b.value=!0,f.value=o},i=o=>{u.value=!0,v.value=o};return K(()=>{w()}),(o,a)=>{const x=te,h=fe,U=ce,B=ne;return n(),S("div",null,[l(j,{title:"ðŸ” Roles y Permisos"},{default:e(()=>[l(q,null,{default:e(()=>[l(z,{class:"justify-space-between"},{default:e(()=>[l(_,{cols:"3"},{default:e(()=>[l(Y,{placeholder:"Search Role",density:"compact",class:"me-3",modelValue:t(d),"onUpdate:modelValue":a[0]||(a[0]=D=>I(d)?d.value=D:null),onKeyup:oe(w,["enter"])},null,8,["modelValue"])]),_:1}),l(_,{cols:"2",class:"text-end"},{default:e(()=>[("isPermission"in o?o.isPermission:t(L))("register_role")?(n(),g($,{key:0,onClick:a[1]||(a[1]=D=>c.value=!t(c))},{default:e(()=>[y(" Add Role "),l(G,{end:"",icon:"ri-add-line"})]),_:1})):k("",!0)]),_:1})]),_:1})]),_:1}),l(se,{headers:A,items:t(s),"items-per-page":5,class:"text-no-wrap"},{"item.id":e(({item:D})=>[r("span",_e,V(D.id),1)]),"item.permissions_pluck":e(({item:D})=>[r("ul",null,[(n(!0),S(N,null,O(D.permissions_pluck,(X,le)=>(n(),S("li",{key:le},V(X),1))),128))])]),"item.action":e(({item:D})=>[r("div",ve,[("isPermission"in o?o.isPermission:t(L))("edit_role")?(n(),g(x,{key:0,size:"small",onClick:X=>m(D)},{default:e(()=>[l(G,{icon:"ri-pencil-line"})]),_:2},1032,["onClick"])):k("",!0),("isPermission"in o?o.isPermission:t(L))("delete_role")?(n(),g(x,{key:1,size:"small",onClick:X=>i(D)},{default:e(()=>[l(G,{icon:"ri-delete-bin-line"})]),_:2},1032,["onClick"])):k("",!0)])]),_:1},8,["items"])]),_:1}),l(h,{isDialogVisible:t(c),"onUpdate:isDialogVisible":a[2]||(a[2]=D=>I(c)?c.value=D:null),onAddRole:R},null,8,["isDialogVisible"]),t(f)&&t(b)?(n(),g(U,{key:0,isDialogVisible:t(b),"onUpdate:isDialogVisible":a[3]||(a[3]=D=>I(b)?b.value=D:null),roleSelected:t(f),onEditRole:C},null,8,["isDialogVisible","roleSelected"])):k("",!0),t(v)&&t(u)?(n(),g(B,{key:1,isDialogVisible:t(u),"onUpdate:isDialogVisible":a[4]||(a[4]=D=>I(u)?u.value=D:null),roleSelected:t(v),onDeleteRole:P},null,8,["isDialogVisible","roleSelected"])):k("",!0)])}}};export{Ge as default};
